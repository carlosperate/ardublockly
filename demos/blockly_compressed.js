// Do not edit this file; automatically generated by build.py.
var Blockly={pathToBlockly:"./",SVG_NS:"http://www.w3.org/2000/svg",HTML_NS:"http://www.w3.org/1999/xhtml",HSV_SATURATION:0.45,HSV_VALUE:0.65,makeColour:function(a){var a=a%360,b=Blockly.HSV_VALUE,c=Blockly.HSV_VALUE*(1-Blockly.HSV_SATURATION),d=(b-c)*(a%60/60)+c,e=(b-c)*(1-a%60/60)+c,f;0<=a&&60>a?(a=b,f=d,b=c):60<=a&&120>a?(a=e,f=b,b=c):120<=a&&180>a?(a=c,f=b,b=d):180<=a&&240>a?(a=c,f=e):240<=a&&300>a?(a=d,f=c):300<=a&&360>a?(a=b,f=c,b=e):b=f=a=0;a=Math.floor(16*a);f=Math.floor(16*f);b=Math.floor(16*
b);return"#"+"0123456789abcdef".charAt(a)+"0123456789abcdef".charAt(f)+"0123456789abcdef".charAt(b)},INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4,LOCAL_VARIABLE:5,DUMMY_INPUT:6,OPPOSITE_TYPE:[]};Blockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE]=Blockly.OUTPUT_VALUE;Blockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE]=Blockly.INPUT_VALUE;Blockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT]=Blockly.PREVIOUS_STATEMENT;Blockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT]=Blockly.NEXT_STATEMENT;
Blockly.SOUNDS_={};Blockly.selected=null;Blockly.editable=!0;Blockly.highlightedConnection_=null;Blockly.localConnection_=null;Blockly.DRAG_RADIUS=5;Blockly.SNAP_RADIUS=12;Blockly.BUMP_DELAY=250;Blockly.svgDoc=null;Blockly.mainWorkspace=null;Blockly.svgSize=function(){return{width:Blockly.svg.cachedWidth_,height:Blockly.svg.cachedHeight_,top:Blockly.svg.cachedTop_,left:Blockly.svg.cachedLeft_}};
Blockly.svgResize=function(){var a=Blockly.svg.parentNode.offsetWidth,b=Blockly.svg.parentNode.offsetHeight;Blockly.svg.cachedWidth_!=a&&(Blockly.svg.setAttribute("width",a+"px"),Blockly.svg.cachedWidth_=a);Blockly.svg.cachedHeight_!=b&&(Blockly.svg.setAttribute("height",b+"px"),Blockly.svg.cachedHeight_=b);a=Blockly.svg.getBoundingClientRect();Blockly.svg.cachedLeft_=a.left;Blockly.svg.cachedTop_=a.top};
Blockly.onMouseDown_=function(a){Blockly.hideChaff();Blockly.removeAllRanges();if(!(Blockly.isTargetInput_(a)||Blockly.Mutator&&Blockly.Mutator.isOpen))if(Blockly.selected&&"svg"==a.target.nodeName&&Blockly.selected.unselect(),2==a.button)Blockly.ContextMenu&&Blockly.showContextMenu_(a.clientX,a.clientY);else if("svg"==a.target.nodeName||!Blockly.editable)Blockly.mainWorkspace.dragMode=!0,Blockly.mainWorkspace.startDragMouseX=a.clientX,Blockly.mainWorkspace.startDragMouseY=a.clientY,Blockly.mainWorkspace.startDragMetrics=
Blockly.getMainWorkspaceMetrics(),Blockly.mainWorkspace.startScrollX=Blockly.mainWorkspace.scrollX,Blockly.mainWorkspace.startScrollY=Blockly.mainWorkspace.scrollY};Blockly.onMouseUp_=function(){Blockly.setCursorHand_(!1);Blockly.mainWorkspace.dragMode=!1};
Blockly.onMouseMove_=function(a){if(Blockly.mainWorkspace.dragMode){Blockly.removeAllRanges();var b=Blockly.mainWorkspace.startDragMetrics,c=Blockly.mainWorkspace.startScrollX+(a.clientX-Blockly.mainWorkspace.startDragMouseX),a=Blockly.mainWorkspace.startScrollY+(a.clientY-Blockly.mainWorkspace.startDragMouseY),c=Math.min(c,-b.contentLeft),a=Math.min(a,-b.contentTop),c=Math.max(c,b.viewWidth-b.contentLeft-b.contentWidth),a=Math.max(a,b.viewHeight-b.contentTop-b.contentHeight);Blockly.mainWorkspace.scrollbar.set(-c-
b.contentLeft,-a-b.contentTop)}};Blockly.onKeyDown_=function(a){if(!Blockly.isTargetInput_(a))if(27==a.keyCode)Blockly.hideChaff(),Blockly.Mutator&&Blockly.Mutator.isOpen&&Blockly.Mutator.closeDialog();else if(8==a.keyCode||46==a.keyCode){if(Blockly.selected&&Blockly.selected.editable&&(!Blockly.Mutator||!Blockly.Mutator.isOpen))Blockly.hideChaff(),Blockly.playAudio("delete"),Blockly.selected.destroy(!0);a.preventDefault()}};
Blockly.showContextMenu_=function(a,b){var c=[],d={enabled:!1};d.text=Blockly.MSG_HELP;d.callback=function(){};c.push(d);Blockly.ContextMenu.show(a,b,c)};Blockly.onContextMenu_=function(a){!Blockly.isTargetInput_(a)&&Blockly.ContextMenu&&a.preventDefault()};Blockly.hideChaff=function(a){Blockly.Tooltip&&Blockly.Tooltip.hide();Blockly.ContextMenu&&Blockly.ContextMenu.hide();Blockly.FieldDropdown.hideMenu();Blockly.Toolbox&&(!a&&Blockly.Toolbox.flyout_.autoClose)&&Blockly.Toolbox.clearSelection()};
Blockly.removeAllRanges=function(){if(window.getSelection){var a=window.getSelection();a&&a.removeAllRanges&&(a.removeAllRanges(),window.setTimeout(function(){window.getSelection().removeAllRanges()},0))}};Blockly.isTargetInput_=function(a){return"textarea"==a.target.type||"text"==a.target.type};Blockly.loadAudio_=function(a){if(Audio){var b=new Audio(Blockly.pathToBlockly+"media/"+a+".wav");b&&b.play&&(b.play(),b.pause(),Blockly.SOUNDS_[a]=b)}};
Blockly.playAudio=function(a){(a=Blockly.SOUNDS_[a])&&a.play()};Blockly.setCursorHand_=function(a){if(Blockly.editable){var b="";a&&(b="url("+Blockly.pathToBlockly+"media/handclosed.cur) 7 3, auto");Blockly.selected&&(Blockly.selected.getSvgRoot().style.cursor=b);Blockly.svgDoc.getElementsByTagName("svg")[0].style.cursor=b}};
Blockly.getMainWorkspaceMetrics=function(){var a=Blockly.svgSize();Blockly.Toolbox&&(a.width-=Blockly.Toolbox.width);var b=a.width-Blockly.Scrollbar.scrollbarThickness,c=a.height-Blockly.Scrollbar.scrollbarThickness;try{var d=Blockly.mainWorkspace.getCanvas().getBBox()}catch(e){return null}-Infinity==d.width&&-Infinity==d.height&&(d={width:0,height:0,x:0,y:0});var f=Math.min(d.x-b/2,d.x+d.width-b),b=Math.max(d.x+d.width+b/2,d.x+b),g=Math.min(d.y-c/2,d.y+d.height-c),c=Math.max(d.y+d.height+c/2,d.y+
c),d=0;Blockly.Toolbox&&!Blockly.RTL&&(d=Blockly.Toolbox.width);return{viewHeight:a.height,viewWidth:a.width,contentHeight:c-g,contentWidth:b-f,viewTop:-Blockly.mainWorkspace.scrollY,viewLeft:-Blockly.mainWorkspace.scrollX,contentTop:g,contentLeft:f,absoluteTop:0,absoluteLeft:d}};
Blockly.setMainWorkspaceMetrics=function(a){var b=Blockly.getMainWorkspaceMetrics();"number"==typeof a.x&&(Blockly.mainWorkspace.scrollX=-b.contentWidth*a.x-b.contentLeft);"number"==typeof a.y&&(Blockly.mainWorkspace.scrollY=-b.contentHeight*a.y-b.contentTop);a="translate("+(Blockly.mainWorkspace.scrollX+b.absoluteLeft)+","+(Blockly.mainWorkspace.scrollY+b.absoluteTop)+")";Blockly.mainWorkspace.getCanvas().setAttribute("transform",a);Blockly.commentCanvas.setAttribute("transform",a)};
Blockly.cssLoaded=function(){Blockly.Toolbox&&Blockly.Toolbox.redraw()};Blockly.Block=function(a,b){this.id=Blockly.uniqueId();this.titleRow=[];this.previousConnection=this.nextConnection=this.outputConnection=null;this.inputList=[];this.rendered=this.inputsInline=!1;this.comment=null;this.collapsed=!1;this.editable=a.editable;this.tooltip="";this.contextMenu=!0;this.parentBlock_=null;this.childBlocks_=[];this.isInFlyout=!1;this.workspace=a;a.addTopBlock(this);if(b){this.type=b;var c=Blockly.Language[b];if(!c)throw'Error: "'+b+'" is an unknown language block.';for(var d in c)this[d]=
c[d]}"function"==typeof this.init&&this.init()};Blockly.Block.prototype.svg_=null;Blockly.Block.prototype.initSvg=function(){this.svg_=new Blockly.BlockSvg(this);this.svg_.init();Blockly.bindEvent_(this.svg_.getRootNode(),"mousedown",this,this.onMouseDown_);this.workspace.getCanvas().appendChild(this.svg_.getRootNode())};Blockly.Block.prototype.getSvgRoot=function(){return this.svg_&&this.svg_.getRootNode()};Blockly.Block.dragMode_=0;Blockly.Block.onMouseUpWrapper_=null;
Blockly.Block.onMouseMoveWrapper_=null;Blockly.Block.unbindDragEvents_=function(){Blockly.Block.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Block.onMouseUpWrapper_),Blockly.Block.onMouseUpWrapper_=null);Blockly.Block.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Block.onMouseMoveWrapper_),Blockly.Block.onMouseMoveWrapper_=null)};
Blockly.Block.prototype.select=function(){Blockly.selected&&Blockly.selected.unselect();Blockly.selected=this;this.svg_.addSelect();Blockly.fireUiEvent(Blockly.svgDoc,this.workspace.getCanvas(),"blocklySelectChange")};Blockly.Block.prototype.unselect=function(){Blockly.selected=null;this.svg_.removeSelect();Blockly.fireUiEvent(Blockly.svgDoc,this.workspace.getCanvas(),"blocklySelectChange")};
Blockly.Block.prototype.destroy=function(a){if(this.outputConnection)this.setParent(null);else{var b=null;this.previousConnection&&this.previousConnection.targetConnection&&(b=this.previousConnection.targetConnection,this.setParent(null));if(a&&this.nextConnection&&this.nextConnection.targetConnection){var a=this.nextConnection.targetConnection,c=this.nextConnection.targetBlock();this.nextConnection.disconnect();c.setParent(null);b&&b.connect(a)}}this.workspace.removeTopBlock(this);this.rendered=
!1;Blockly.selected==this&&(Blockly.selected=null,Blockly.Block.unbindDragEvents_());for(b=this.childBlocks_.length-1;0<=b;b--)this.childBlocks_[b].destroy(!1);for(b=0;b<this.titleRow.length;b++)this.titleRow[b].destroy();this.comment&&this.comment.destroy();this.mutator&&this.mutator.destroy();for(b=0;b<this.inputList.length;b++)a=this.inputList[b],a.label&&a.label.destroy(),a.destroy&&a.destroy();this.inputList=[];a=this.getConnections_(!0);for(b=0;b<a.length;b++)c=a[b],c.targetConnection&&c.disconnect(),
a[b].destroy();this.svg_&&(this.svg_.destroy(),this.svg_=null)};Blockly.Block.prototype.getRelativeToSurfaceXY=function(){var a=this.svg_.getRootNode(),b=0,c=0;do var d=Blockly.getRelativeXY_(a),b=b+d.x,c=c+d.y,a=a.parentNode;while(a&&a!=this.workspace.getCanvas());return{x:b,y:c}};Blockly.Block.prototype.moveBy=function(a,b){var c=this.getRelativeToSurfaceXY();this.svg_.getRootNode().setAttribute("transform","translate("+(c.x+a)+", "+(c.y+b)+")");this.moveConnections_(a,b)};
Blockly.Block.prototype.onMouseDown_=function(a){Blockly.svgResize();Blockly.Block.unbindDragEvents_();this.select();Blockly.hideChaff(this.isInFlyout);if(2==a.button)Blockly.ContextMenu&&this.showContextMenu_(a.clientX,a.clientY);else if(this.editable){Blockly.removeAllRanges();Blockly.setCursorHand_(!0);var b=this.getRelativeToSurfaceXY();this.startDragX=b.x;this.startDragY=b.y;this.startDragMouseX=a.clientX;this.startDragMouseY=a.clientY;Blockly.Block.dragMode_=1;Blockly.Block.onMouseUpWrapper_=
Blockly.bindEvent_(Blockly.svgDoc,"mouseup",this,this.onMouseUp_);Blockly.Block.onMouseMoveWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mousemove",this,this.onMouseMove_);this.draggedComments_=[];for(var b=this.getDescendants(),c=0,d;d=b[c];c++)if(d.comment){var e=d.comment.getIconLocation();e.comment=d.comment;this.draggedComments_.push(e)}}else return;a.stopPropagation()};
Blockly.Block.prototype.onMouseUp_=function(){Blockly.Block.unbindDragEvents_();if(2==Blockly.Block.dragMode_){if(Blockly.selected!=this)throw"Dragging no object?";this.setDragging_(!1);var a=this.getRelativeToSurfaceXY();this.moveConnections_(a.x-this.startDragX,a.y-this.startDragY);var b=this;Blockly.fireUiEvent(Blockly.svgDoc,window,"resize");window.setTimeout(function(){b.bumpNeighbours_()},Blockly.BUMP_DELAY)}Blockly.Block.dragMode_=0;delete this.draggedComments_;if(Blockly.selected&&Blockly.highlightedConnection_)Blockly.playAudio("click"),
Blockly.localConnection_.connect(Blockly.highlightedConnection_),this.workspace.trashcan&&this.workspace.trashcan.isOpen&&Blockly.Trashcan.close(this.workspace.trashcan);else if(this.workspace.trashcan&&this.workspace.trashcan.isOpen){Blockly.playAudio("delete");Blockly.selected.destroy(!1);var c=this.workspace.trashcan;window.setTimeout(function(){Blockly.Trashcan.close(c)},100);Blockly.fireUiEvent(Blockly.svgDoc,window,"resize")}Blockly.highlightedConnection_&&(Blockly.highlightedConnection_.unhighlight(),
Blockly.highlightedConnection_=null)};Blockly.Block.prototype.showHelp_=function(){var a="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;a&&window.open(a)};Blockly.Block.prototype.duplicate_=function(){var a=Blockly.Xml.blockToDom_(this),a=Blockly.Xml.domToBlock_(this.workspace,a),b=this.getRelativeToSurfaceXY();b.x+=Blockly.SNAP_RADIUS;b.y+=2*Blockly.SNAP_RADIUS;a.moveBy(b.x,b.y)};
Blockly.Block.prototype.showContextMenu_=function(a,b){if(this.contextMenu){var c=this,d=[];if(this.editable){d.push({text:Blockly.MSG_DUPLICATE_BLOCK,enabled:!0,callback:function(){c.duplicate_()}});if(Blockly.Comment&&!this.collapsed){var e={enabled:!0};this.comment?(e.text=Blockly.MSG_REMOVE_COMMENT,e.callback=function(){c.setCommentText(null)}):(e.text=Blockly.MSG_ADD_COMMENT,e.callback=function(){c.setCommentText("")});d.push(e)}if(!this.collapsed)for(e=0;e<this.inputList.length;e++)if(this.inputList[e].type==
Blockly.INPUT_VALUE){e={enabled:!0};e.text=this.inputsInline?Blockly.MSG_EXTERNAL_INPUTS:Blockly.MSG_INLINE_INPUTS;e.callback=function(){c.setInputsInline(!c.inputsInline)};d.push(e);break}this.collapsed?(e={enabled:!0},e.text=Blockly.MSG_EXPAND_BLOCK,e.callback=function(){c.setCollapsed(!1)},d.push(e)):this.inputList.length&&(e={enabled:!0},e.text=Blockly.MSG_COLLAPSE_BLOCK,e.callback=function(){c.setCollapsed(!0)},d.push(e));e=this.getDescendants().length;c.nextConnection&&c.nextConnection.targetConnection&&
(e-=this.nextConnection.targetBlock().getDescendants().length);e={text:1==e?Blockly.MSG_DELETE_BLOCK:Blockly.MSG_DELETE_X_BLOCKS.replace("%1",e),enabled:!0,callback:function(){Blockly.playAudio("delete");c.destroy(true)}};d.push(e)}e={enabled:!!("function"==typeof this.helpUrl?this.helpUrl():this.helpUrl)};e.text=Blockly.MSG_HELP;e.callback=function(){c.showHelp_()};d.push(e);Blockly.ContextMenu.show(a,b,d)}};
Blockly.Block.prototype.getConnections_=function(a){var b=[];if(a||this.rendered)if(this.outputConnection&&b.push(this.outputConnection),this.nextConnection&&b.push(this.nextConnection),this.previousConnection&&b.push(this.previousConnection),a||!this.collapsed)for(var a=0,c;c=this.inputList[a];a++)c.type!=Blockly.LOCAL_VARIABLE&&c.type!=Blockly.DUMMY_INPUT&&b.push(c);return b};
Blockly.Block.prototype.moveConnections_=function(a,b){if(this.rendered){for(var c=this.getConnections_(!1),d=0;d<c.length;d++)c[d].moveBy(a,b);this.comment&&this.comment.computeIconLocation();for(d=0;d<this.childBlocks_.length;d++)this.childBlocks_[d].moveConnections_(a,b)}};Blockly.Block.prototype.setDragging_=function(a){a?this.svg_.addDragging():this.svg_.removeDragging();for(var b=0;b<this.childBlocks_.length;b++)this.childBlocks_[b].setDragging_(a)};
Blockly.Block.prototype.onMouseMove_=function(a){Blockly.removeAllRanges();var b=a.clientX-this.startDragMouseX,c=a.clientY-this.startDragMouseY;1==Blockly.Block.dragMode_&&Math.sqrt(Math.pow(b,2)+Math.pow(c,2))>Blockly.DRAG_RADIUS&&(Blockly.Block.dragMode_=2,this.setParent(null),this.setDragging_(!0));if(2==Blockly.Block.dragMode_){var d=this.startDragX+b,e=this.startDragY+c;this.svg_.getRootNode().setAttribute("transform","translate("+d+", "+e+")");for(d=0;d<this.draggedComments_.length;d++)e=this.draggedComments_[d],
e.comment.setIconLocation(e.x+b,e.y+c);for(var d=this.getConnections_(!1),f=e=null,g=Blockly.SNAP_RADIUS,h=0;h<d.length;h++){var i=d[h],j=i.closest(g,b,c);j.connection&&(e=j.connection,f=i,g=j.radius)}Blockly.highlightedConnection_&&Blockly.highlightedConnection_!=e&&(Blockly.highlightedConnection_.unhighlight(),Blockly.highlightedConnection_=null,Blockly.localConnection_=null);e&&e!=Blockly.highlightedConnection_&&(e.highlight(),Blockly.highlightedConnection_=e,Blockly.localConnection_=f);this.workspace.trashcan&&
this.workspace.trashcan.onMouseMove(a)}a.stopPropagation()};Blockly.Block.prototype.bumpNeighbours_=function(){for(var a=this.getRootBlock(),b=this.getConnections_(!1),c=0;c<b.length;c++){var d=b[c];d.targetConnection&&(d.type==Blockly.INPUT_VALUE||d.type==Blockly.NEXT_STATEMENT)&&d.targetBlock().bumpNeighbours_();for(var e=d.neighbours_(Blockly.SNAP_RADIUS),f=0;f<e.length;f++){var g=e[f];(!d.targetConnection||!g.targetConnection)&&g.sourceBlock_.getRootBlock()!=a&&g.bumpAwayFrom_(d)}}};
Blockly.Block.prototype.getParent=function(){return this.parentBlock_};Blockly.Block.prototype.getRootBlock=function(){var a,b=this;do a=b,b=a.parentBlock_;while(b);return a};Blockly.Block.prototype.getChildren=function(){return this.childBlocks_};
Blockly.Block.prototype.setParent=function(a){if(this.parentBlock_){for(var b=this.parentBlock_.childBlocks_,c,d=0;c=b[d];d++)if(c==this){b.splice(d,1);break}b=this.getRelativeToSurfaceXY();this.workspace.getCanvas().appendChild(this.svg_.getRootNode());this.svg_.getRootNode().setAttribute("transform","translate("+b.x+", "+b.y+")");this.previousConnection&&this.previousConnection.targetConnection&&this.previousConnection.disconnect();this.outputConnection&&this.outputConnection.targetConnection&&
this.outputConnection.disconnect()}else this.workspace.removeTopBlock(this);(this.parentBlock_=a)?(a.childBlocks_.push(this),b=this.getRelativeToSurfaceXY(),a.svg_.getRootNode().appendChild(this.svg_.getRootNode()),a=this.getRelativeToSurfaceXY(),this.moveConnections_(a.x-b.x,a.y-b.y)):this.workspace.addTopBlock(this)};Blockly.Block.prototype.getDescendants=function(){for(var a=[this],b,c=0;b=this.childBlocks_[c];c++)a=a.concat(b.getDescendants());return a};Blockly.Block.prototype.getColour=function(){return this.colourHue_};
Blockly.Block.prototype.setColour=function(a){this.colourHue_=a;this.svg_&&this.svg_.updateColour();this.comment&&this.comment.updateColour();this.rendered&&this.render()};Blockly.Block.prototype.appendTitle=function(a,b){"string"==typeof a&&(a=new Blockly.FieldLabel(a));a.name=b;this.titleRow.push(a);this.svg_&&a.init(this);this.rendered&&(this.render(),this.bumpNeighbours_());return a};
Blockly.Block.prototype.getTitle_=function(a){for(var b=0,c;c=this.titleRow[b];b++)if(c.name===a)return c;for(b=0;c=this.inputList[b];b++)if(c.label&&c.label.name===a)return c.label;return null};Blockly.Block.prototype.getTitleText=function(a){return(a=this.getTitle_(a))?a.getText():null};Blockly.Block.prototype.getTitleValue=function(a){return(a=this.getTitle_(a))?a.getValue():null};
Blockly.Block.prototype.setTitleText=function(a,b){var c=this.getTitle_(b);if(c)c.setText(a);else throw'Title "'+b+'" not found.';};Blockly.Block.prototype.setTitleValue=function(a,b){var c=this.getTitle_(b);if(c)c.setValue(a);else throw'Title "'+b+'" not found.';};Blockly.Block.prototype.setTooltip=function(a){this.tooltip=a};
Blockly.Block.prototype.setPreviousStatement=function(a){if(this.previousConnection){if(this.previousConnection.targetConnection)throw"Must disconnect previous statement before removing connection.";this.previousConnection.destroy();this.previousConnection=null}if(a){if(this.outputConnection)throw"Remove output connection prior to adding previous connection.";this.previousConnection=new Blockly.Connection(this,Blockly.PREVIOUS_STATEMENT,null)}this.rendered&&(this.render(),this.bumpNeighbours_())};
Blockly.Block.prototype.setNextStatement=function(a){if(this.nextConnection){if(this.nextConnection.targetConnection)throw"Must disconnect next statement before removing connection.";this.nextConnection.destroy();this.nextConnection=null}a&&(this.nextConnection=new Blockly.Connection(this,Blockly.NEXT_STATEMENT,null));this.rendered&&(this.render(),this.bumpNeighbours_())};
Blockly.Block.prototype.setOutput=function(a,b){if(this.outputConnection){if(this.outputConnection.targetConnection)throw"Must disconnect output value before removing connection.";this.outputConnection.destroy();this.outputConnection=null}if(a){if(this.previousConnection)throw"Remove previous connection prior to adding output connection.";this.outputConnection=new Blockly.Connection(this,Blockly.OUTPUT_VALUE,b)}this.rendered&&(this.render(),this.bumpNeighbours_())};
Blockly.Block.prototype.setInputsInline=function(a){this.inputsInline=a;this.rendered&&(this.render(),this.bumpNeighbours_())};
Blockly.Block.prototype.setCollapsed=function(a){if(this.collapsed!=a){for(var b=(this.collapsed=a)?"none":"block",c=[],d=0,e;e=this.inputList[d];d++)if(e.label&&((e.label.getRootElement?e.label.getRootElement():e.label).style.display=b),e.targetBlock){if(a?e.hideAll():c=c.concat(e.unhideAll()),e=e.targetBlock())e.svg_.getRootNode().style.display=b,a&&(e.rendered=!1)}else e.getText&&e.setVisible(!a);a&&this.comment&&this.comment.setPinned(!1);0==c.length&&(c[0]=this);if(this.rendered){for(d=0;a=c[d];d++)a.render();
this.bumpNeighbours_()}}};
Blockly.Block.prototype.appendInput=function(a,b,c,d){var e=null;a&&("string"==typeof a?e=new Blockly.FieldLabel(a):a instanceof Array&&(e=a[0],e.name=a[1]),this.svg_&&e.init(this));b==Blockly.DUMMY_INPUT?(a={},a.type=b):b==Blockly.LOCAL_VARIABLE?(a=new Blockly.FieldDropdown(Blockly.Variables.dropdownCreate,Blockly.Variables.dropdownChange),this.svg_&&a.init(this),a.type=Blockly.LOCAL_VARIABLE):a=new Blockly.Connection(this,b,d);a.label=e;a.name=c;this.inputList.push(a);this.rendered&&(this.render(),
this.bumpNeighbours_());return a};Blockly.Block.prototype.removeInput=function(a){for(var b=0,c;c=this.inputList[b];b++)if(c.name==a){c.targetConnection&&c.targetBlock().setParent(null);(a=c.label)&&a.destroy();c.destroy&&c.destroy();this.inputList.splice(b,1);this.rendered&&(this.render(),this.bumpNeighbours_());return}throw'Input "'+a+'" not found.';};Blockly.Block.prototype.getInput=function(a){for(var b=0,c;c=this.inputList[b];b++)if(c.name==a)return c;return null};
Blockly.Block.prototype.getInputTargetBlock=function(a){return(a=this.getInput(a))&&a.targetBlock()};Blockly.Block.prototype.getInputVariable=function(a){return(a=this.getInput(a))&&a.getText()};Blockly.Block.prototype.setInputVariable=function(a,b){var c=this.getInput(a);if(!c)throw"Input does not exist.";c.setText(b)};Blockly.Block.prototype.setMutator=function(a){this.mutator&&this.mutator!==a&&(this.mutator.destroy(),this.mutator=null);a&&(a.block_=this,this.mutator=a,this.svg_&&a.createIcon())};
Blockly.Block.prototype.getCommentText=function(){return this.comment?this.comment.getText().replace(/\s+$/,"").replace(/ +\n/g,"\n"):""};Blockly.Block.prototype.setCommentText=function(a){if(!Blockly.Comment)throw"Comments not supported.";var b=!1;"string"==typeof a?(this.comment||(this.comment=new Blockly.Comment(this,Blockly.commentCanvas),b=!0),this.comment.setText(a)):this.comment&&(this.comment.destroy(),this.comment=null,b=!0);this.rendered&&(this.render(),b&&this.bumpNeighbours_())};
Blockly.Block.prototype.render=function(){this.svg_.render()};Blockly.BlockSvg=function(a){this.block_=a;this.svgGroup_=Blockly.createSvgElement("g",{},null);this.svgPathDark_=Blockly.createSvgElement("path",{transform:"translate(1, 1)"},this.svgGroup_);this.svgPath_=Blockly.createSvgElement("path",{},this.svgGroup_);this.svgPathLight_=Blockly.createSvgElement("path",{fill:"none","stroke-width":2,"stroke-linecap":"round"},this.svgGroup_);this.svgPath_.tooltip=this.block_;Blockly.Tooltip&&Blockly.Tooltip.bindMouseEvents(this.svgPath_);a.editable&&Blockly.addClass_(this.svgGroup_,
"blocklyDraggable")};Blockly.BlockSvg.INLINE=-1;Blockly.BlockSvg.prototype.init=function(){var a=this.block_;this.updateColour();for(var b=0;b<a.titleRow.length;b++)a.titleRow[b].init(a,this);for(var b=0,c;c=a.inputList[b];b++)c.label&&c.label.init(a,this),c.type==Blockly.LOCAL_VARIABLE&&c.init(a,this);a.mutator&&a.mutator.createIcon()};Blockly.BlockSvg.prototype.getRootNode=function(){return this.svgGroup_};Blockly.BlockSvg.SEP_SPACE_X=10;Blockly.BlockSvg.SEP_SPACE_Y=5;
Blockly.BlockSvg.MIN_BLOCK_Y=25;Blockly.BlockSvg.TAB_HEIGHT=20;Blockly.BlockSvg.TAB_WIDTH=8;Blockly.BlockSvg.NOTCH_WIDTH=30;Blockly.BlockSvg.CORNER_RADIUS=8;Blockly.BlockSvg.DISTANCE_45_INSIDE=(1-Math.SQRT1_2)*(Blockly.BlockSvg.CORNER_RADIUS-1)+1;Blockly.BlockSvg.DISTANCE_45_OUTSIDE=(1-Math.SQRT1_2)*(Blockly.BlockSvg.CORNER_RADIUS+1)-1;Blockly.BlockSvg.NOTCH_PATH_LEFT="l 6,4 3,0 6,-4";Blockly.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT="l 6.5,4 2,0 6.5,-4";Blockly.BlockSvg.NOTCH_PATH_RIGHT="l -6,4 -3,0 -6,-4";
Blockly.BlockSvg.JAGGED_TEETH="l 8,0 0,4 8,4 -16,8 8,4";Blockly.BlockSvg.TAB_PATH_DOWN="v 5 c 0,10 -"+Blockly.BlockSvg.TAB_WIDTH+",-8 -"+Blockly.BlockSvg.TAB_WIDTH+",7.5 s "+Blockly.BlockSvg.TAB_WIDTH+",-2.5 "+Blockly.BlockSvg.TAB_WIDTH+",7.5";Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL="v 6.5 m -"+0.98*Blockly.BlockSvg.TAB_WIDTH+",2.5 q -"+0.05*Blockly.BlockSvg.TAB_WIDTH+",10 "+0.27*Blockly.BlockSvg.TAB_WIDTH+",10 m "+0.71*Blockly.BlockSvg.TAB_WIDTH+",-2.5 v 1.5";
Blockly.BlockSvg.prototype.destroy=function(){this.svgGroup_.parentNode.removeChild(this.svgGroup_);this.block_=this.svgPathDark_=this.svgPathLight_=this.svgPath_=this.svgGroup_=null};
Blockly.BlockSvg.prototype.updateColour=function(){var a=Blockly.makeColour(this.block_.getColour()),b=window.parseInt(a.charAt(1),16),c=window.parseInt(a.charAt(2),16),d=window.parseInt(a.charAt(3),16),e="0123456789abcdef".charAt(Math.min(b+3,15)),f="0123456789abcdef".charAt(Math.min(c+2,15)),g="0123456789abcdef".charAt(Math.min(d+2,15)),b="0123456789abcdef".charAt(Math.max(b-4,0)),c="0123456789abcdef".charAt(Math.max(c-4,0)),d="0123456789abcdef".charAt(Math.max(d-4,0));this.svgPathLight_.setAttribute("stroke",
"#"+e+f+g);this.svgPathDark_.setAttribute("fill","#"+b+c+d);this.svgPath_.setAttribute("fill",a)};Blockly.BlockSvg.prototype.addSelect=function(){Blockly.addClass_(this.svgPath_,"blocklySelected");this.svgPathLight_.setAttribute("display","none");this.svgGroup_.parentNode.appendChild(this.svgGroup_)};Blockly.BlockSvg.prototype.removeSelect=function(){Blockly.removeClass_(this.svgPath_,"blocklySelected");this.svgPathLight_.setAttribute("display","block")};
Blockly.BlockSvg.prototype.addDragging=function(){Blockly.addClass_(this.svgPath_,"blocklyDragging");Blockly.addClass_(this.svgPathLight_,"blocklyDragging");this.svgPathDark_.style.display="none"};Blockly.BlockSvg.prototype.removeDragging=function(){Blockly.removeClass_(this.svgPath_,"blocklyDragging");Blockly.removeClass_(this.svgPathLight_,"blocklyDragging");this.svgPathDark_.style.display="block"};
Blockly.BlockSvg.prototype.render=function(){this.block_.rendered=!0;var a=18;if(!this.block_.collapsed&&this.block_.inputsInline&&this.block_.inputList.length){var b=0;do{var c=this.block_.inputList[b];if(c&&c.type==Blockly.INPUT_VALUE){a+=Blockly.BlockSvg.SEP_SPACE_Y;break}b++}while(c&&c.type==Blockly.LOCAL_VARIABLE)}a=Blockly.RTL?this.renderTitleRTL_(a):this.renderTitleLTR_(a);b=this.renderCompute_(this.block_.inputList);this.renderDraw_(a,b);(a=this.block_.getParent())?a.render():Blockly.fireUiEvent(Blockly.svgDoc,
window,"resize")};
Blockly.BlockSvg.prototype.renderTitleRTL_=function(a){var b=-Blockly.BlockSvg.SEP_SPACE_X,c;this.block_.comment&&(c=this.block_.comment.renderIcon(b))&&(b-=c+Blockly.BlockSvg.SEP_SPACE_X);this.block_.mutator&&(c=this.block_.mutator.renderIcon(b))&&(b-=c+Blockly.BlockSvg.SEP_SPACE_X);c=0;for(var d;d=this.block_.titleRow[c];c++){var e=d.width(),b=b-e;d.getRootElement().setAttribute("transform","translate("+b+", "+a+")");e&&(b-=Blockly.BlockSvg.SEP_SPACE_X)}if(this.block_.previousConnection||this.block_.nextConnection)b=
Math.min(b,-Blockly.BlockSvg.NOTCH_WIDTH-Blockly.BlockSvg.SEP_SPACE_X);return-b};
Blockly.BlockSvg.prototype.renderTitleLTR_=function(a){var b=Blockly.BlockSvg.SEP_SPACE_X,c;this.block_.comment&&(c=this.block_.comment.renderIcon(b))&&(b+=c+Blockly.BlockSvg.SEP_SPACE_X);this.block_.mutator&&(c=this.block_.mutator.renderIcon(b))&&(b+=c+Blockly.BlockSvg.SEP_SPACE_X);c=0;for(var d;d=this.block_.titleRow[c];c++)d.getRootElement().setAttribute("transform","translate("+b+", "+a+")"),(d=d.width())&&(b+=d+Blockly.BlockSvg.SEP_SPACE_X);if(this.block_.previousConnection||this.block_.nextConnection)b=
Math.max(b,Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.SEP_SPACE_X);return b};
Blockly.BlockSvg.prototype.renderCompute_=function(a){var b=[];b.labelValueWidth=0;b.labelVariableWidth=0;b.labelStatementWidth=0;b.hasValue=!1;b.hasVariable=!1;b.hasStatement=!1;var c=void 0;if(this.block_.collapsed)return b;for(var d=0,e;e=a[d];d++){var f;!this.block_.inputsInline||!(c==Blockly.INPUT_VALUE||c==Blockly.LOCAL_VARIABLE||c==Blockly.DUMMY_INPUT)||!(e.type==Blockly.INPUT_VALUE||e.type==Blockly.LOCAL_VARIABLE||e.type==Blockly.DUMMY_INPUT)?(c=e.type,f=[],f.type=this.block_.inputsInline&&
(e.type==Blockly.INPUT_VALUE||e.type==Blockly.LOCAL_VARIABLE||e.type==Blockly.DUMMY_INPUT)?Blockly.BlockSvg.INLINE:e.type,f.height=0,b.push(f)):f=b[b.length-1];f.push(e);e.renderHeight=Blockly.BlockSvg.MIN_BLOCK_Y;e.renderWidth=NaN;this.block_.inputsInline&&(e.type==Blockly.INPUT_VALUE?e.renderWidth=Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X:e.type==Blockly.LOCAL_VARIABLE?e.renderWidth=e.width()+Blockly.BlockSvg.SEP_SPACE_X:e.type==Blockly.DUMMY_INPUT&&(e.renderWidth=0));if(e.targetConnection){var g=
e.targetBlock().getSvgRoot();try{var h=g.getBBox()}catch(i){h={height:0,width:0}}-1!=window.navigator.userAgent.indexOf("AppleWebKit/")&&(h.height-=5);e.renderHeight=Math.max(e.renderHeight,h.height-1);e.renderWidth=Math.max(e.renderWidth,h.width)}f.height=Math.max(f.height,e.renderHeight);e.label?e.label.getComputedTextLength?e.labelWidth=e.label.getComputedTextLength():(g=e.label.render(),e.labelWidth=g?g.width:0):e.labelWidth=0;f.type==Blockly.BlockSvg.INLINE?1==f.length&&(b.labelValueWidth=Math.max(b.labelValueWidth,
e.labelWidth)):f.type==Blockly.DUMMY_INPUT?b.labelValueWidth=Math.max(b.labelValueWidth,e.labelWidth):f.type==Blockly.INPUT_VALUE?(b.hasValue=!0,b.labelValueWidth=Math.max(b.labelValueWidth,e.labelWidth)):f.type==Blockly.NEXT_STATEMENT?(b.hasStatement=!0,b.labelStatementWidth=Math.max(b.labelStatementWidth,e.labelWidth)):f.type==Blockly.LOCAL_VARIABLE&&(b.hasVariable=!0,b.labelVariableWidth=Math.max(b.labelVariableWidth,e.labelWidth))}if(this.block_.inputsInline)for(a=0;a<b.length;a++)if(f=b[a],f.type==
Blockly.BlockSvg.INLINE)for(c=0;c<f.length;c++)if(e=f[c],e.type==Blockly.INPUT_VALUE){f.height+=2*Blockly.BlockSvg.SEP_SPACE_Y;break}return b};
Blockly.BlockSvg.prototype.renderDraw_=function(a,b){var c=this.block_.getRelativeToSurfaceXY(),d=a;b.hasStatement&&(d=Math.max(d,Blockly.BlockSvg.SEP_SPACE_X+b.labelStatementWidth+Blockly.BlockSvg.SEP_SPACE_X+Blockly.BlockSvg.NOTCH_WIDTH));b.hasValue&&(d=Math.max(d,a+(b.labelValueWidth?b.labelValueWidth+Blockly.BlockSvg.SEP_SPACE_X:0)+Blockly.BlockSvg.TAB_WIDTH));b.hasVariable&&(d=Math.max(d,a+(b.labelVariableWidth?b.labelVariableWidth+Blockly.BlockSvg.SEP_SPACE_X:0)+Blockly.BlockSvg.TAB_WIDTH));
var e=[],f=[],g=[],h=[];this.renderDrawTop_(e,g,c,d);d=this.renderDrawRight_(e,g,f,h,c,d,b,a);this.renderDrawBottom_(e,g,c,d);this.renderDrawLeft_(e,g,c,d);c=e.join(" ")+"\n"+f.join(" ");this.svgPath_.setAttribute("d",c);this.svgPathDark_.setAttribute("d",c);c=g.join(" ")+"\n"+h.join(" ");this.svgPathLight_.setAttribute("d",c);Blockly.RTL&&(this.svgPath_.setAttribute("transform","scale(-1 1)"),this.svgPathLight_.setAttribute("transform","scale(-1 1)"),this.svgPathDark_.setAttribute("transform","translate(1,1) scale(-1 1)"))};
Blockly.BlockSvg.prototype.renderDrawTop_=function(a,b,c,d){this.block_.outputConnection?(a.push("m 0,0"),b.push("m 1,1")):(a.push("m 0,"+Blockly.BlockSvg.CORNER_RADIUS),Blockly.RTL?b.push("m "+Blockly.BlockSvg.DISTANCE_45_INSIDE+","+Blockly.BlockSvg.DISTANCE_45_INSIDE):b.push("m 1,"+(Blockly.BlockSvg.CORNER_RADIUS-1)),Blockly.BlockSvg.CORNER_RADIUS&&(a.push("A",Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0"),b.push("A",Blockly.BlockSvg.CORNER_RADIUS-
1+","+(Blockly.BlockSvg.CORNER_RADIUS-1)+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",1")));this.block_.previousConnection&&(a.push("H",Blockly.BlockSvg.NOTCH_WIDTH-15),b.push("H",Blockly.BlockSvg.NOTCH_WIDTH-15),a.push(Blockly.BlockSvg.NOTCH_PATH_LEFT),b.push(Blockly.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT),this.block_.previousConnection.moveTo(c.x+(Blockly.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH),c.y));a.push("H",d);b.push("H",d+(Blockly.RTL?-1:0))};
Blockly.BlockSvg.prototype.renderDrawRight_=function(a,b,c,d,e,f,g,h){for(var i=0,j=0,l,n,o=0;o<g.length;o++){b.push("M",f-1+","+(j+1));var m=g[o];if(m.type==Blockly.BlockSvg.INLINE){for(var i=Math.max(h+g.labelValueWidth,g.labelStatementWidth),i=i-m[0].labelWidth,q=0;q<m.length;q++){var k=m[q];if(k.label){l=k.label.getRootElement();n=Blockly.RTL?-i-k.labelWidth:i;var p=j+18+Blockly.BlockSvg.SEP_SPACE_Y;l.setAttribute("transform","translate("+n+","+p+")");i+=k.labelWidth+Blockly.BlockSvg.SEP_SPACE_X}k.type!=
Blockly.DUMMY_INPUT&&(i+=k.renderWidth+Blockly.BlockSvg.SEP_SPACE_X);k.type==Blockly.INPUT_VALUE?(c.push("M",i-Blockly.BlockSvg.SEP_SPACE_X+","+(j+Blockly.BlockSvg.SEP_SPACE_Y)),c.push("h",Blockly.BlockSvg.TAB_WIDTH-k.renderWidth),c.push(Blockly.BlockSvg.TAB_PATH_DOWN),c.push("v",k.renderHeight-Blockly.BlockSvg.TAB_HEIGHT),c.push("h",k.renderWidth-Blockly.BlockSvg.TAB_WIDTH),c.push("z"),Blockly.RTL?(d.push("M",i-Blockly.BlockSvg.SEP_SPACE_X+Blockly.BlockSvg.TAB_WIDTH-k.renderWidth-1+","+(j+Blockly.BlockSvg.SEP_SPACE_Y+
1)),d.push(Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),d.push("v",k.renderHeight-Blockly.BlockSvg.TAB_HEIGHT+2),d.push("h",k.renderWidth-Blockly.BlockSvg.TAB_WIDTH)):(d.push("M",i-Blockly.BlockSvg.SEP_SPACE_X+1+","+(j+Blockly.BlockSvg.SEP_SPACE_Y+1)),d.push("v",k.renderHeight),d.push("h",Blockly.BlockSvg.TAB_WIDTH-k.renderWidth),d.push("M",i-k.renderWidth-Blockly.BlockSvg.SEP_SPACE_X+3.8+","+(j+Blockly.BlockSvg.SEP_SPACE_Y+Blockly.BlockSvg.TAB_HEIGHT-0.4)),d.push("l",0.42*Blockly.BlockSvg.TAB_WIDTH+
",-1.8")),l=Blockly.RTL?e.x-i-Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X+k.renderWidth-1:e.x+i+Blockly.BlockSvg.TAB_WIDTH-Blockly.BlockSvg.SEP_SPACE_X-k.renderWidth+1,n=e.y+j+Blockly.BlockSvg.SEP_SPACE_Y,k.moveTo(l,n),k.targetConnection&&k.tighten_()):k.type==Blockly.LOCAL_VARIABLE&&(l=k.getRootElement(),k=k.width(),Blockly.RTL?l.setAttribute("transform","translate("+(-i+1.5*Blockly.BlockSvg.SEP_SPACE_X)+", "+(j+18+Blockly.BlockSvg.SEP_SPACE_Y)+")"):l.setAttribute("transform","translate("+
(i-k-1.5*Blockly.BlockSvg.SEP_SPACE_X)+", "+(j+18+Blockly.BlockSvg.SEP_SPACE_Y)+")"))}a.push("H",i);b.push("H",i+(Blockly.RTL?-1:0));a.push("v",m.height);Blockly.RTL&&b.push("v",m.height-2)}else if(m.type==Blockly.INPUT_VALUE)k=m[0],k.label&&(l=k.label.getRootElement(),n=Blockly.RTL?-f+Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X:f-Blockly.BlockSvg.TAB_WIDTH-Blockly.BlockSvg.SEP_SPACE_X-k.labelWidth,p=j+18,l.setAttribute("transform","translate("+n+","+p+")")),a.push(Blockly.BlockSvg.TAB_PATH_DOWN),
a.push("v",m.height-Blockly.BlockSvg.TAB_HEIGHT),Blockly.RTL?(b.push(Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),b.push("v",m.height-Blockly.BlockSvg.TAB_HEIGHT)):(b.push("M",f-4.2+","+(j+Blockly.BlockSvg.TAB_HEIGHT-0.4)),b.push("l",0.42*Blockly.BlockSvg.TAB_WIDTH+",-1.8")),l=e.x+(Blockly.RTL?-f-1:f+1),n=e.y+j,k.moveTo(l,n),k.targetConnection&&k.tighten_();else if(m.type==Blockly.DUMMY_INPUT)k=m[0],k.label&&(l=k.label.getRootElement(),n=Blockly.RTL?-f+Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X:
f-Blockly.BlockSvg.TAB_WIDTH-Blockly.BlockSvg.SEP_SPACE_X-k.labelWidth,p=j+18,l.setAttribute("transform","translate("+n+","+p+")")),a.push("v",m.height),Blockly.RTL&&b.push("v",m.height-2);else if(m.type==Blockly.LOCAL_VARIABLE)(k=m[0],k.label&&(l=k.label.getRootElement(),p=j+18,n=Blockly.RTL?-f+Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X:f-Blockly.BlockSvg.TAB_WIDTH-Blockly.BlockSvg.SEP_SPACE_X-k.labelWidth,l.setAttribute("transform","translate("+n+","+p+")")),l=k.getRootElement(),k=
k.width(),Blockly.RTL?l.setAttribute("transform","translate("+(-f-k+Blockly.BlockSvg.SEP_SPACE_X/2)+", "+(j+18)+")"):l.setAttribute("transform","translate("+(f-Blockly.BlockSvg.SEP_SPACE_X/2)+", "+(j+18)+")"),k+=Blockly.BlockSvg.SEP_SPACE_X/2,a.push("H",f+k),a.push("v",m.height),a.push("h",-k),Blockly.RTL)?(b.push("h",k),b.push("v",m.height-2),b.push("m",-k+",0")):b.push("h",k+1);else if(m.type==Blockly.NEXT_STATEMENT&&(k=m[0],0==o&&(a.push("v",Blockly.BlockSvg.MIN_BLOCK_Y),Blockly.RTL&&b.push("v",
Blockly.BlockSvg.MIN_BLOCK_Y-2),j+=Blockly.BlockSvg.MIN_BLOCK_Y),k.label&&(l=k.label.getRootElement(),Blockly.RTL?l.setAttribute("x",-Blockly.BlockSvg.SEP_SPACE_X-g.labelStatementWidth):l.setAttribute("x",Blockly.BlockSvg.SEP_SPACE_X+g.labelStatementWidth-k.labelWidth),l.setAttribute("y",j+18)),i=Blockly.BlockSvg.SEP_SPACE_X+g.labelStatementWidth+Blockly.BlockSvg.SEP_SPACE_X+Blockly.BlockSvg.NOTCH_WIDTH,a.push("H",i),a.push(Blockly.BlockSvg.NOTCH_PATH_RIGHT+" h -"+(Blockly.BlockSvg.NOTCH_WIDTH-15-
Blockly.BlockSvg.CORNER_RADIUS)),Blockly.BlockSvg.CORNER_RADIUS&&a.push("a",Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS),a.push("v",m.height-2*Blockly.BlockSvg.CORNER_RADIUS),Blockly.BlockSvg.CORNER_RADIUS&&a.push("a",Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS),a.push("H",f),Blockly.RTL?(b.push("M",i-Blockly.BlockSvg.NOTCH_WIDTH+
Blockly.BlockSvg.DISTANCE_45_OUTSIDE+","+(j+Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),b.push("a",Blockly.BlockSvg.CORNER_RADIUS+1+","+(Blockly.BlockSvg.CORNER_RADIUS+1)+" 0 0,0 "+(-Blockly.BlockSvg.DISTANCE_45_OUTSIDE-1)+","+(Blockly.BlockSvg.CORNER_RADIUS-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),b.push("v",m.height-2*Blockly.BlockSvg.CORNER_RADIUS),b.push("a",Blockly.BlockSvg.CORNER_RADIUS+1+","+(Blockly.BlockSvg.CORNER_RADIUS+1)+" 0 0,0 "+(Blockly.BlockSvg.CORNER_RADIUS+1)+","+(Blockly.BlockSvg.CORNER_RADIUS+
1)),b.push("H",f-1)):(b.push("M",i-Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.DISTANCE_45_OUTSIDE+","+(j+m.height-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),b.push("a",Blockly.BlockSvg.CORNER_RADIUS+1+","+(Blockly.BlockSvg.CORNER_RADIUS+1)+" 0 0,0 "+(Blockly.BlockSvg.CORNER_RADIUS-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)+","+(Blockly.BlockSvg.DISTANCE_45_OUTSIDE+1)),b.push("H",f)),l=e.x+(Blockly.RTL?-i:i),n=e.y+j+1,k.moveTo(l,n),k.targetConnection&&k.tighten_(),o==g.length-1||g[o+1].type==Blockly.NEXT_STATEMENT))a.push("v",
Blockly.BlockSvg.SEP_SPACE_Y),Blockly.RTL&&b.push("v",Blockly.BlockSvg.SEP_SPACE_Y-1),j+=Blockly.BlockSvg.SEP_SPACE_Y;j+=m.height}g.length||(this.block_.collapsed&&(a.push(Blockly.BlockSvg.JAGGED_TEETH),Blockly.RTL?b.push("l 8,0 0,3.8 7,3.2 m -14.5,9 l 8,4"):b.push("h 8")),a.push("V",Blockly.BlockSvg.MIN_BLOCK_Y),Blockly.RTL&&b.push("V",Blockly.BlockSvg.MIN_BLOCK_Y-1),j=Blockly.BlockSvg.MIN_BLOCK_Y);return j};
Blockly.BlockSvg.prototype.renderDrawBottom_=function(a,b,c,d){this.block_.nextConnection&&(a.push("H",Blockly.BlockSvg.NOTCH_WIDTH+" "+Blockly.BlockSvg.NOTCH_PATH_RIGHT),this.block_.nextConnection.moveTo(Blockly.RTL?c.x-Blockly.BlockSvg.NOTCH_WIDTH:c.x+Blockly.BlockSvg.NOTCH_WIDTH,c.y+d+1),this.block_.nextConnection.targetConnection&&this.block_.nextConnection.tighten_());this.block_.outputConnection?a.push("H 0"):(a.push("H",Blockly.BlockSvg.CORNER_RADIUS),Blockly.BlockSvg.CORNER_RADIUS&&(a.push("a",
Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+",-"+Blockly.BlockSvg.CORNER_RADIUS),Blockly.RTL||(b.push("M",Blockly.BlockSvg.DISTANCE_45_INSIDE+","+(d-Blockly.BlockSvg.DISTANCE_45_INSIDE)),b.push("A",Blockly.BlockSvg.CORNER_RADIUS-1+","+(Blockly.BlockSvg.CORNER_RADIUS-1)+" 0 0,1 1,"+(d-Blockly.BlockSvg.CORNER_RADIUS)))))};
Blockly.BlockSvg.prototype.renderDrawLeft_=function(a,b,c,d){this.block_.outputConnection?(a.push("V",Blockly.BlockSvg.TAB_HEIGHT),a.push("c 0,-10 -"+Blockly.BlockSvg.TAB_WIDTH+",8 -"+Blockly.BlockSvg.TAB_WIDTH+",-7.5 s "+Blockly.BlockSvg.TAB_WIDTH+",2.5 "+Blockly.BlockSvg.TAB_WIDTH+",-7.5"),Blockly.RTL?(b.push("M",-0.3*Blockly.BlockSvg.TAB_WIDTH+",8.9"),b.push("l",-0.45*Blockly.BlockSvg.TAB_WIDTH+",-2.1")):(b.push("M","1,"+d),b.push("V",Blockly.BlockSvg.TAB_HEIGHT-1),b.push("m",-0.92*Blockly.BlockSvg.TAB_WIDTH+
",-1 q "+-0.19*Blockly.BlockSvg.TAB_WIDTH+",-5.5 0,-11"),b.push("m",0.92*Blockly.BlockSvg.TAB_WIDTH+",1 V 1 H 2")),this.block_.outputConnection.moveTo(c.x,c.y)):Blockly.RTL||b.push("V",Blockly.BlockSvg.CORNER_RADIUS);a.push("z")};Blockly.Comment=function(a,b){this.block_=a;var c=Blockly.Comment.ARROW_ANGLE;Blockly.RTL&&(c=-c);this.arrow_radians_=2*c/360*Math.PI;this.createIcon_();this.createBubble_(b);this.setPinned(!1);this.updateColour()};Blockly.Comment.ICON_RADIUS=8;Blockly.Comment.BORDER_WIDTH=6;Blockly.Comment.ARROW_THICKNESS=10;Blockly.Comment.ARROW_ANGLE=20;Blockly.Comment.ARROW_BEND=4;Blockly.Comment.onMouseUpWrapper_=null;Blockly.Comment.onMouseMoveWrapper_=null;
Blockly.Comment.unbindDragEvents_=function(){Blockly.Comment.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Comment.onMouseUpWrapper_),Blockly.Comment.onMouseUpWrapper_=null);Blockly.Comment.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Comment.onMouseMoveWrapper_),Blockly.Comment.onMouseMoveWrapper_=null)};Blockly.Comment.prototype.iconX_=null;Blockly.Comment.prototype.iconY_=null;Blockly.Comment.prototype.relativeLeft_=-100;Blockly.Comment.prototype.relativeTop_=-120;
Blockly.Comment.prototype.width_=160;Blockly.Comment.prototype.height_=80;Blockly.Comment.prototype.isPinned_=!1;
Blockly.Comment.prototype.createIcon_=function(){this.iconGroup_=Blockly.createSvgElement("g",{"class":"blocklyIconGroup"},null);Blockly.createSvgElement("circle",{"class":"blocklyIconShield",r:Blockly.Comment.ICON_RADIUS,cx:Blockly.Comment.ICON_RADIUS,cy:Blockly.Comment.ICON_RADIUS},this.iconGroup_);this.iconMark_=Blockly.createSvgElement("text",{"class":"blocklyCommentMark",x:Blockly.Comment.ICON_RADIUS/2,y:2*Blockly.Comment.ICON_RADIUS-3},this.iconGroup_);this.iconMark_.appendChild(Blockly.svgDoc.createTextNode("?"));
this.block_.getSvgRoot().appendChild(this.iconGroup_);Blockly.bindEvent_(this.iconGroup_,"mouseup",this,this.iconClick_);Blockly.bindEvent_(this.iconGroup_,"mouseover",this,this.iconMouseOver_);Blockly.bindEvent_(this.iconGroup_,"mouseout",this,this.iconMouseOut_)};
Blockly.Comment.prototype.createBubble_=function(a){this.bubbleGroup_=Blockly.createSvgElement("g",{},null);var b=Blockly.createSvgElement("g",{filter:"url(#blocklyEmboss)"},this.bubbleGroup_);this.bubbleArrow_=Blockly.createSvgElement("path",{},b);this.bubbleBack_=Blockly.createSvgElement("rect",{"class":"blocklyDraggable",x:0,y:0,rx:Blockly.Comment.BORDER_WIDTH,ry:Blockly.Comment.BORDER_WIDTH},b);this.resizeGroup_=Blockly.createSvgElement("g",{"class":Blockly.RTL?"blocklyResizeSW":"blocklyResizeSE"},
this.bubbleGroup_);b=2*Blockly.Comment.BORDER_WIDTH;Blockly.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,b)},this.resizeGroup_);Blockly.createSvgElement("line",{"class":"blocklyResizeLine",x1:b/3,y1:b-1,x2:b-1,y2:b/3},this.resizeGroup_);Blockly.createSvgElement("line",{"class":"blocklyResizeLine",x1:2*b/3,y1:b-1,x2:b-1,y2:2*b/3},this.resizeGroup_);this.foreignObject_=Blockly.createSvgElement("foreignObject",{x:Blockly.Comment.BORDER_WIDTH,y:Blockly.Comment.BORDER_WIDTH},this.bubbleGroup_);
b=Blockly.svgDoc.createElementNS(Blockly.HTML_NS,"body");b.setAttribute("xmlns",Blockly.HTML_NS);b.className="blocklyMinimalBody";this.textarea_=Blockly.svgDoc.createElementNS(Blockly.HTML_NS,"textarea");this.textarea_.className="blocklyCommentTextarea";this.textarea_.setAttribute("dir",Blockly.RTL?"RTL":"LTR");b.appendChild(this.textarea_);this.foreignObject_.appendChild(b);this.setBubbleSize(this.width_,this.height_);a.appendChild(this.bubbleGroup_);Blockly.bindEvent_(this.bubbleBack_,"mousedown",
this,this.bubbleMouseDown_);Blockly.bindEvent_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_);Blockly.bindEvent_(this.foreignObject_,"mousedown",this,Blockly.noEvent);Blockly.bindEvent_(this.textarea_,"mouseup",this,this.textareaFocus_)};Blockly.Comment.prototype.isPinned=function(){return this.isPinned_};Blockly.Comment.prototype.setPinned=function(a){this.isPinned_=a;this.iconMark_.style.fill=a?"#fff":"";this.setVisible_(a)};
Blockly.Comment.prototype.isVisible_=function(){return"none"!=this.bubbleGroup_.style.display};Blockly.Comment.prototype.setVisible_=function(a){this.bubbleGroup_.style.display=a?"":"none";a&&this.positionBubble_()};Blockly.Comment.prototype.iconClick_=function(){this.setPinned(!this.isPinned_)};Blockly.Comment.prototype.iconMouseOver_=function(){!this.isPinned_&&0==Blockly.Block.dragMode_&&this.setVisible_(!0)};
Blockly.Comment.prototype.iconMouseOut_=function(){!this.isPinned_&&0==Blockly.Block.dragMode_&&this.setVisible_(!1)};
Blockly.Comment.prototype.bubbleMouseDown_=function(a){this.promote_();Blockly.Comment.unbindDragEvents_();2!=a.button&&!Blockly.isTargetInput_(a)&&(Blockly.setCursorHand_(!0),this.dragDeltaX=Blockly.RTL?this.relativeLeft_+a.clientX:this.relativeLeft_-a.clientX,this.dragDeltaY=this.relativeTop_-a.clientY,Blockly.Comment.onMouseUpWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mouseup",this,Blockly.Comment.unbindDragEvents_),Blockly.Comment.onMouseMoveWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mousemove",
this,this.bubbleMouseMove_),Blockly.hideChaff(),a.stopPropagation())};Blockly.Comment.prototype.bubbleMouseMove_=function(a){this.relativeLeft_=Blockly.RTL?this.dragDeltaX-a.clientX:this.dragDeltaX+a.clientX;this.relativeTop_=this.dragDeltaY+a.clientY;this.positionBubble_();this.renderArrow_()};
Blockly.Comment.prototype.resizeMouseDown_=function(a){this.promote_();Blockly.Comment.unbindDragEvents_();2!=a.button&&(Blockly.setCursorHand_(!0),this.resizeDeltaWidth=Blockly.RTL?this.width_+a.clientX:this.width_-a.clientX,this.resizeDeltaHeight=this.height_-a.clientY,Blockly.Comment.onMouseUpWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mouseup",this,Blockly.Comment.unbindDragEvents_),Blockly.Comment.onMouseMoveWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mousemove",this,this.resizeMouseMove_),Blockly.hideChaff(),
a.stopPropagation())};Blockly.Comment.prototype.resizeMouseMove_=function(a){var b=this.resizeDeltaWidth,c=this.resizeDeltaHeight+a.clientY,b=Blockly.RTL?b-a.clientX:b+a.clientX;this.setBubbleSize(b,c);Blockly.RTL&&this.positionBubble_()};Blockly.Comment.prototype.textareaFocus_=function(){this.promote_();this.textarea_.focus()};Blockly.Comment.prototype.promote_=function(){this.bubbleGroup_.parentNode.appendChild(this.bubbleGroup_)};
Blockly.Comment.prototype.getBubbleLocation=function(){return{x:this.relativeLeft_,y:this.relativeTop_}};Blockly.Comment.prototype.setBubbleLocation=function(a,b){this.relativeLeft_=a;this.relativeTop_=b;this.positionBubble_()};
Blockly.Comment.prototype.positionBubble_=function(){if(this.isVisible_()&&!(null===this.iconX_||null===this.iconY_))this.bubbleGroup_.setAttribute("transform","translate("+(Blockly.RTL?this.iconX_-this.relativeLeft_-this.width_:this.iconX_+this.relativeLeft_)+", "+(this.relativeTop_+this.iconY_)+")")};Blockly.Comment.prototype.getBubbleSize=function(){return{width:this.width_,height:this.height_}};
Blockly.Comment.prototype.setBubbleSize=function(a,b){var c=2*Blockly.Comment.BORDER_WIDTH,a=Math.max(a,c+45),b=Math.max(b,c+18);this.width_=a;this.height_=b;this.bubbleBack_.setAttribute("width",a);this.bubbleBack_.setAttribute("height",b);Blockly.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*Blockly.Comment.BORDER_WIDTH+", "+(b-c)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(a-c)+", "+(b-c)+")");this.foreignObject_.setAttribute("width",a-c);this.foreignObject_.setAttribute("height",
b-c);this.textarea_.style.width=a-c-4+"px";this.textarea_.style.height=b-c-4+"px";this.renderArrow_()};
Blockly.Comment.prototype.renderArrow_=function(){if(this.isVisible_()){var a=[],b=this.width_/2,c=this.height_/2,d=-this.relativeLeft_,e=-this.relativeTop_;if(b==d&&c==e)a.push("M "+b+","+c);else{e-=c;d-=b;Blockly.RTL&&(d*=-1);var f=Math.sqrt(e*e+d*d),g=Math.acos(d/f);0>e&&(g=2*Math.PI-g);var h=g+Math.PI/2;h>2*Math.PI&&(h-=2*Math.PI);var i=Math.sin(h),j=Math.cos(h),l=this.getBubbleSize(),h=(l.width+l.height)/Blockly.Comment.ARROW_THICKNESS,h=Math.min(h,l.width,l.height)/2,l=1-Blockly.Comment.ICON_RADIUS/
f,d=b+l*d,e=c+l*e,l=b+h*j,n=c+h*i,b=b-h*j,c=c-h*i,i=g+this.arrow_radians_;i>2*Math.PI&&(i-=2*Math.PI);g=Math.sin(i)*f/Blockly.Comment.ARROW_BEND;f=Math.cos(i)*f/Blockly.Comment.ARROW_BEND;a.push("M"+l+","+n);a.push("C"+(l+f)+","+(n+g)+" "+d+","+e+" "+d+","+e);a.push("C"+d+","+e+" "+(b+f)+","+(c+g)+" "+b+","+c)}a.push("z");this.bubbleArrow_.setAttribute("d",a.join(" "))}};Blockly.Comment.prototype.getText=function(){return this.textarea_.value};
Blockly.Comment.prototype.setText=function(a){this.textarea_.value=a};Blockly.Comment.prototype.updateColour=function(){var a=Blockly.makeColour(this.block_.getColour());this.bubbleBack_.setAttribute("fill",a);this.bubbleArrow_.setAttribute("fill",a)};
Blockly.Comment.prototype.destroy=function(){Blockly.Comment.unbindDragEvents_();this.iconGroup_.parentNode.removeChild(this.iconGroup_);this.iconGroup_=null;this.bubbleGroup_.parentNode.removeChild(this.bubbleGroup_);this.bubbleGroup_=this.textarea_=null;this.block_=this.block_.comment=null};
Blockly.Comment.prototype.renderIcon=function(a){if(this.block_.collapsed)return this.iconGroup_.setAttribute("display","none"),0;this.iconGroup_.setAttribute("display","block");var b=2*Blockly.Comment.ICON_RADIUS;Blockly.RTL&&(a-=b);this.iconGroup_.setAttribute("transform","translate("+a+", 5)");this.computeIconLocation();-1!=window.navigator.userAgent.indexOf("Chrome/")&&this.positionBubble_();return b};Blockly.Comment.prototype.setIconLocation=function(a,b){this.iconX_=a;this.iconY_=b;this.positionBubble_()};
Blockly.Comment.prototype.computeIconLocation=function(){var a=this.block_.getRelativeToSurfaceXY(),b=Blockly.getRelativeXY_(this.iconGroup_),c=a.x+b.x+Blockly.Comment.ICON_RADIUS,a=a.y+b.y+Blockly.Comment.ICON_RADIUS;if(c!==this.iconX_||a!==this.iconY_)this.iconX_=c,this.iconY_=a,this.positionBubble_()};Blockly.Comment.prototype.getIconLocation=function(){return{x:this.iconX_,y:this.iconY_}};Blockly.Connection=function(a,b,c){this.sourceBlock_=a;this.targetConnection=null;this.type=b;c?(c instanceof Array||(c=[c]),this.check_=c):this.check_=null;this.y_=this.x_=0;this.inDB_=!1;this.dbList_=this.sourceBlock_.workspace.connectionDBList};
Blockly.Connection.prototype.destroy=function(){if(this.targetConnection)throw"Disconnect connection before destroying it.";this.inDB_&&this.dbList_[this.type].removeConnection_(this);this.inDB_=!1;Blockly.highlightedConnection_==this&&(Blockly.highlightedConnection_=null);Blockly.localConnection_==this&&(Blockly.localConnection_=null)};
Blockly.Connection.prototype.connect=function(a){if(this.sourceBlock_==a.sourceBlock_)throw"Attempted to connect a block to itself.";if(this.sourceBlock_.workspace!==a.sourceBlock_.workspace)throw"Blocks are on different workspaces.";if(Blockly.OPPOSITE_TYPE[this.type]!=a.type)throw"Attempt to connect incompatible types.";if(this.type==Blockly.INPUT_VALUE||this.type==Blockly.OUTPUT_VALUE){if(this.targetConnection)throw"Source connection already connected (value).";if(a.targetConnection){var b=a.targetBlock();
b.setParent(null);for(var c=function(a){for(var c=!1,d=0;d<a.inputList.length;d++)if(a.inputList[d].type==Blockly.INPUT_VALUE&&b.outputConnection.checkType_(a.inputList[d])){if(c)return null;c=a.inputList[d]}return c},d=this.sourceBlock_;d=c(d);)if(d.targetBlock())d=d.targetBlock();else{d.connect(b.outputConnection);b=null;break}b&&window.setTimeout(function(){b.outputConnection.bumpAwayFrom_(a)},Blockly.BUMP_DELAY)}}else{if(this.targetConnection)throw"Source connection already connected (block).";
if(a.targetConnection){if(this.type!=Blockly.PREVIOUS_STATEMENT)throw"Can only do a mid-stack connection with the top of a block.";b=a.targetBlock();b.setParent(null);for(d=this.sourceBlock_;d.nextConnection;)if(d.nextConnection.targetConnection)d=d.nextConnection.targetBlock();else{d.nextConnection.connect(b.previousConnection);b=null;break}b&&window.setTimeout(function(){b.previousConnection.bumpAwayFrom_(a)},Blockly.BUMP_DELAY)}}this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT?
(c=this.sourceBlock_,d=a.sourceBlock_):(c=a.sourceBlock_,d=this.sourceBlock_);this.targetConnection=a;a.targetConnection=this;d.setParent(c);c.rendered&&c.render()};
Blockly.Connection.prototype.disconnect=function(){var a=this.targetConnection;if(a){if(a.targetConnection!=this)throw"Target connection not connected to source connection.";}else throw"Source connection not connected.";this.targetConnection=a.targetConnection=null;a=this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT?this.sourceBlock_:a.sourceBlock_;a.rendered&&a.render()};
Blockly.Connection.prototype.targetBlock=function(){return this.targetConnection?this.targetConnection.sourceBlock_:null};
Blockly.Connection.prototype.bumpAwayFrom_=function(a){if(0==Blockly.Block.dragMode_){var b=this.sourceBlock_.getRootBlock(),c=!1;if(!b.editable){b=a.sourceBlock_.getRootBlock();if(!b.editable)return;a=this;c=!0}b.getSvgRoot().parentNode.appendChild(b.getSvgRoot());var d=a.x_+Blockly.SNAP_RADIUS-this.x_,a=a.y_+2*Blockly.SNAP_RADIUS-this.y_;c&&(a=-a);Blockly.RTL&&(d=-d);b.moveBy(d,a)}};
Blockly.Connection.prototype.moveTo=function(a,b){this.inDB_&&this.dbList_[this.type].removeConnection_(this);this.x_=a;this.y_=b;this.dbList_[this.type].addConnection_(this)};Blockly.Connection.prototype.moveBy=function(a,b){this.moveTo(this.x_+a,this.y_+b)};
Blockly.Connection.prototype.highlight=function(){var a;this.type==Blockly.INPUT_VALUE||this.type==Blockly.OUTPUT_VALUE?(a=Blockly.RTL?-Blockly.BlockSvg.TAB_WIDTH:Blockly.BlockSvg.TAB_WIDTH,a="m 0,0 v 5 c 0,10 "+-a+",-8 "+-a+",7.5 s "+a+",-2.5 "+a+",7.5 v 5"):a=Blockly.RTL?"m 20,0 h -5 l -6,4 -3,0 -6,-4 h -5":"m -20,0 h 5 l 6,4 3,0 6,-4 h 5";var b=this.sourceBlock_.getRelativeToSurfaceXY();Blockly.Connection.highlightedPath_=Blockly.createSvgElement("path",{"class":"blocklyHighlightedConnectionPath",
d:a,transform:"translate("+(this.x_-b.x)+", "+(this.y_-b.y)+")"},this.sourceBlock_.getSvgRoot())};Blockly.Connection.prototype.unhighlight=function(){var a=Blockly.Connection.highlightedPath_;a.parentNode.removeChild(a);delete Blockly.Connection.highlightedPath_};
Blockly.Connection.prototype.tighten_=function(){var a=Math.round(this.targetConnection.x_-this.x_),b=Math.round(this.targetConnection.y_-this.y_);if(0!=a||0!=b){var c=this.targetBlock(),d=Blockly.getRelativeXY_(c.getSvgRoot());c.getSvgRoot().setAttribute("transform","translate("+(d.x-a)+", "+(d.y-b)+")");c.moveConnections_(-a,-b)}};
Blockly.Connection.prototype.closest=function(a,b,c){function d(b){var c=e[b];if((c.type==Blockly.OUTPUT_VALUE||c.type==Blockly.PREVIOUS_STATEMENT)&&c.targetConnection||!l.checkType_(c))return!0;c=c.sourceBlock_;do{if(j==c)return!0;c=c.getParent()}while(c);var d=f-e[b].x_,c=g-e[b].y_,d=Math.sqrt(d*d+c*c);d<=a&&(i=e[b],a=d);return c<a}if(this.targetConnection)return{connection:null,radius:a};for(var e=this.dbList_[Blockly.OPPOSITE_TYPE[this.type]],f=this.x_+b,g=this.y_+c,b=0,h=c=e.length-2;b<h;)e[h].y_<
g?b=h:c=h,h=Math.floor((b+c)/2);var c=b=h,i=null,j=this.sourceBlock_,l=this;if(e.length){for(;0<=b&&d(b);)b--;do c++;while(c<e.length&&d(c))}return{connection:i,radius:a}};Blockly.Connection.prototype.checkType_=function(a){if(!this.check_||!a.check_)return!0;for(var b=0;b<this.check_.length;b++)if(-1!=a.check_.indexOf(this.check_[b]))return!0;return!1};
Blockly.Connection.prototype.neighbours_=function(a){function b(b){var f=d-c[b].x_,g=e-c[b].y_;Math.sqrt(f*f+g*g)<=a&&i.push(c[b]);return g<a}for(var c=this.dbList_[Blockly.OPPOSITE_TYPE[this.type]],d=this.x_,e=this.y_,f=0,g=c.length-2,h=g;f<h;)c[h].y_<e?f=h:g=h,h=Math.floor((f+g)/2);var g=f=h,i=[];if(c.length){for(;0<=f&&b(f);)f--;do g++;while(g<c.length&&b(g))}return i};
Blockly.Connection.prototype.hideAll=function(){this.inDB_&&this.dbList_[this.type].removeConnection_(this);if(this.targetConnection)for(var a=this.targetBlock().getDescendants(),b=0;b<a.length;b++){for(var c=a[b],d=c.getConnections_(!0),e=0;e<d.length;e++){var f=d[e];f.inDB_&&this.dbList_[f.type].removeConnection_(f)}c.comment&&c.comment.setVisible_(!1)}};
Blockly.Connection.prototype.unhideAll=function(){this.inDB_||this.dbList_[this.type].addConnection_(this);var a=[];if(this.type!=Blockly.INPUT_VALUE&&this.type!=Blockly.NEXT_STATEMENT)return a;var b=this.targetBlock();if(b){var c;b.collapsed?(c=[],b.outputConnection&&c.push(b.outputConnection),b.nextConnection&&c.push(b.nextConnection),b.previousConnection&&c.push(b.previousConnection)):c=b.getConnections_(!0);for(var d=0;d<c.length;d++)a=a.concat(c[d].unhideAll());0==a.length&&(a[0]=b);b.comment&&
b.comment.isPinned()&&b.comment.setVisible_(!0)}return a};Blockly.ConnectionDB=function(){};Blockly.ConnectionDB.prototype=[];Blockly.ConnectionDB.prototype.addConnection_=function(a){if(a.inDB_)throw"Connection already in database.";for(var b=0,c=this.length;b<c;){var d=Math.floor((b+c)/2);if(this[d].y_<a.y_)b=d+1;else if(this[d].y_>a.y_)c=d;else{b=d;break}}this.splice(b,0,a);a.inDB_=!0};
Blockly.ConnectionDB.prototype.removeConnection_=function(a){if(!a.inDB_)throw"Connection not in database.";a.inDB_=!1;for(var b=0,c=this.length-2,d=c;b<d;)this[d].y_<a.y_?b=d:c=d,d=Math.floor((b+c)/2);for(c=b=d;0<=b&&this[b].y_==a.y_;){if(this[b]==a){this.splice(b,1);return}b--}do{if(this[c]==a){this.splice(c,1);return}c++}while(c<this.length&&this[c].y_==a.y_);throw"Unable to find connection in connectionDB.";};
Blockly.ConnectionDB.init=function(a){var b=[];b[Blockly.INPUT_VALUE]=new Blockly.ConnectionDB;b[Blockly.OUTPUT_VALUE]=new Blockly.ConnectionDB;b[Blockly.NEXT_STATEMENT]=new Blockly.ConnectionDB;b[Blockly.PREVIOUS_STATEMENT]=new Blockly.ConnectionDB;a.connectionDBList=b};Blockly.ContextMenu={};Blockly.ContextMenu.X_PADDING=20;Blockly.ContextMenu.Y_HEIGHT=20;Blockly.ContextMenu.visible=!1;
Blockly.ContextMenu.createDom=function(){var a=Blockly.createSvgElement("g",{"class":"blocklyHidden"},null);Blockly.ContextMenu.svgGroup=a;Blockly.ContextMenu.svgShadow=Blockly.createSvgElement("rect",{"class":"blocklyContextMenuShadow",x:2,y:-2,rx:4,ry:4},a);Blockly.ContextMenu.svgBackground=Blockly.createSvgElement("rect",{"class":"blocklyContextMenuBackground",y:-4,rx:4,ry:4},a);Blockly.ContextMenu.svgOptions=Blockly.createSvgElement("g",{"class":"blocklyContextMenuOptions"},a);return a};
Blockly.ContextMenu.show=function(a,b,c){0==c.length&&Blockly.ContextMenu.hide();Blockly.removeChildren_(Blockly.ContextMenu.svgOptions);Blockly.ContextMenu.svgGroup.style.display="block";for(var d=0,e=[Blockly.ContextMenu.svgBackground,Blockly.ContextMenu.svgShadow],f=0,g;g=c[f];f++){var h=Blockly.ContextMenu.optionToDom(g.text),i=h.firstChild,j=h.lastChild;Blockly.ContextMenu.svgOptions.appendChild(h);h.setAttribute("transform","translate(0, "+f*Blockly.ContextMenu.Y_HEIGHT+")");e.push(i);Blockly.bindEvent_(h,
"mousedown",null,Blockly.noEvent);g.enabled?(Blockly.bindEvent_(h,"mouseup",null,g.callback),Blockly.bindEvent_(h,"mouseup",null,Blockly.ContextMenu.hide)):h.setAttribute("class","blocklyMenuDivDisabled");d=Math.max(d,j.getComputedTextLength())}d+=2*Blockly.ContextMenu.X_PADDING;for(f=0;f<e.length;f++)e[f].setAttribute("width",d);if(Blockly.RTL)for(f=0;h=Blockly.ContextMenu.svgOptions.childNodes[f];f++)j=h.lastChild,j.setAttribute("x",d-j.getComputedTextLength()-Blockly.ContextMenu.X_PADDING);Blockly.ContextMenu.svgBackground.setAttribute("height",
c.length*Blockly.ContextMenu.Y_HEIGHT+8);Blockly.ContextMenu.svgShadow.setAttribute("height",c.length*Blockly.ContextMenu.Y_HEIGHT+10);c=Blockly.ContextMenu.svgGroup.getBBox();d=Blockly.svgSize();a-=d.left;b-=d.top;b+c.height>d.height&&(b-=c.height-10);Blockly.RTL?0>=a-c.width?a++:a-=c.width:a+c.width>d.width?a-=c.width:a++;Blockly.ContextMenu.svgGroup.setAttribute("transform","translate("+a+", "+b+")");Blockly.ContextMenu.visible=!0};
Blockly.ContextMenu.optionToDom=function(a){var b=Blockly.createSvgElement("g",{"class":"blocklyMenuDiv"},null);Blockly.createSvgElement("rect",{height:Blockly.ContextMenu.Y_HEIGHT},b);var c=Blockly.createSvgElement("text",{"class":"blocklyMenuText",x:Blockly.ContextMenu.X_PADDING,y:15},b),a=Blockly.svgDoc.createTextNode(a);c.appendChild(a);return b};Blockly.ContextMenu.hide=function(){Blockly.ContextMenu.visible&&(Blockly.ContextMenu.svgGroup.style.display="none",Blockly.ContextMenu.visible=!1)};Blockly.Field=function(a){null!==a&&(this.sourceBlock_=null,this.group_=Blockly.createSvgElement("g",{},null),this.borderRect_=Blockly.createSvgElement("rect",{rx:4,ry:4},this.group_),this.textElement_=Blockly.createSvgElement("text",{"class":"blocklyText"},this.group_),this.CURSOR&&(this.group_.style.cursor=this.CURSOR),this.setText(a))};Blockly.Field.NBSP="\u00a0";Blockly.Field.prototype.EDITABLE=!0;
Blockly.Field.prototype.init=function(a){if(this.sourceBlock_)throw"Field has already been initialized once.";this.sourceBlock_=a;this.group_.setAttribute("class",a.editable?"blocklyEditableText":"blocklyNonEditableText");a.getSvgRoot().appendChild(this.group_);a.editable&&(this.mouseUpWrapper_=Blockly.bindEvent_(this.group_,"mouseup",this,this.onMouseUp_))};
Blockly.Field.prototype.destroy=function(){this.mouseUpWrapper_&&(Blockly.unbindEvent_(this.mouseUpWrapper_),this.mouseUpWrapper_=null);this.sourceBlock_=null;this.group_.parentNode.removeChild(this.group_);this.borderRect_=this.textElement_=this.group_=null};Blockly.Field.prototype.setVisible=function(a){this.getRootElement().style.display=a?"block":"none"};Blockly.Field.prototype.getRootElement=function(){return this.group_};
Blockly.Field.prototype.render=function(){try{var a=this.textElement_.getBBox()}catch(b){return null}0==a.height&&(a.height=18);var c=a.height,d=a.x-Blockly.BlockSvg.SEP_SPACE_X/2,e=a.y;this.borderRect_.setAttribute("width",a.width+Blockly.BlockSvg.SEP_SPACE_X);this.borderRect_.setAttribute("height",c);this.borderRect_.setAttribute("x",d);this.borderRect_.setAttribute("y",e);return a};Blockly.Field.prototype.width=function(){var a=this.render();return!a||-Infinity==a.width?0:a.width};
Blockly.Field.prototype.getText=function(){return this.text_};Blockly.Field.prototype.setText=function(a){this.text_=a;Blockly.removeChildren_(this.textElement_);a=a.replace(/\s/g,Blockly.Field.NBSP);a||(a=Blockly.Field.NBSP);a=Blockly.svgDoc.createTextNode(a);this.textElement_.appendChild(a);this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_())};Blockly.Field.prototype.getValue=function(){return this.getText()};
Blockly.Field.prototype.setValue=function(a){this.setText(a)};Blockly.Field.prototype.onMouseUp_=function(a){2!=a.button&&2!=Blockly.Block.dragMode_&&this.showEditor_()};Blockly.Field.prototype.setTooltip=function(){};Blockly.FieldDropdown=function(a,b){this.menuGenerator_=a;this.changeHandler_=b;var c=this.getOptions_()[0][0];Blockly.Field.call(this,c)};Blockly.FieldDropdown.prototype=new Blockly.Field(null);
Blockly.FieldDropdown.createDom=function(){var a=Blockly.createSvgElement("g",{"class":"blocklyHidden"},null);Blockly.FieldDropdown.svgGroup_=a;Blockly.FieldDropdown.svgShadow_=Blockly.createSvgElement("rect",{"class":"blocklyDropdownMenuShadow",x:0,y:1,rx:2,ry:2},a);Blockly.FieldDropdown.svgBackground_=Blockly.createSvgElement("rect",{x:-2,y:-1,rx:2,ry:2,filter:"url(#blocklyEmboss)"},a);Blockly.FieldDropdown.svgOptions_=Blockly.createSvgElement("g",{"class":"blocklyDropdownMenuOptions"},a);return a};
Blockly.FieldDropdown.CORNER_RADIUS=2;Blockly.FieldDropdown.prototype.CURSOR="default";
Blockly.FieldDropdown.prototype.showEditor_=function(){function a(a){return function(b){this.changeHandler_?this.changeHandler_(a):this.setText(a);b.stopPropagation()}}var b=Blockly.FieldDropdown.svgGroup_,c=Blockly.FieldDropdown.svgOptions_,d=Blockly.FieldDropdown.svgBackground_,e=Blockly.FieldDropdown.svgShadow_;Blockly.removeChildren_(c);b.style.display="block";for(var f=0,g=[],h=null,i=this.getOptions_(),j=0;j<i.length;j++){var l=i[j][0],n=Blockly.ContextMenu.optionToDom(l),o=n.firstChild,m=n.lastChild;
c.appendChild(n);!h&&l==this.text_&&(h=Blockly.createSvgElement("text",{"class":"blocklyMenuText",y:15},null),n.insertBefore(h,m),h.appendChild(Blockly.svgDoc.createTextNode("\u2713")));n.setAttribute("transform","translate(0, "+j*Blockly.ContextMenu.Y_HEIGHT+")");g.push(o);Blockly.bindEvent_(n,"mousedown",null,Blockly.noEvent);Blockly.bindEvent_(n,"mouseup",this,a(l));Blockly.bindEvent_(n,"mouseup",null,Blockly.FieldDropdown.hideMenu);f=Math.max(f,m.getComputedTextLength())}f+=2*Blockly.ContextMenu.X_PADDING;
for(j=0;j<g.length;j++)g[j].setAttribute("width",f);if(Blockly.RTL)for(j=0;n=c.childNodes[j];j++)m=n.lastChild,m.setAttribute("x",f-m.getComputedTextLength()-Blockly.ContextMenu.X_PADDING);h&&(Blockly.RTL?h.setAttribute("x",f-5-h.getComputedTextLength()):h.setAttribute("x",5));j=f+2*Blockly.FieldDropdown.CORNER_RADIUS;i=i.length*Blockly.ContextMenu.Y_HEIGHT+Blockly.FieldDropdown.CORNER_RADIUS+1;e.setAttribute("width",j);e.setAttribute("height",i);d.setAttribute("width",j);d.setAttribute("height",
i);e=Blockly.makeColour(this.sourceBlock_.getColour());d.setAttribute("fill",e);d=Blockly.getAbsoluteXY_(this.borderRect_);e=this.borderRect_.getBBox();j=Blockly.RTL?d.x-f+Blockly.ContextMenu.X_PADDING+e.width-Blockly.BlockSvg.SEP_SPACE_X/2:d.x-Blockly.ContextMenu.X_PADDING+Blockly.BlockSvg.SEP_SPACE_X/2;b.setAttribute("transform","translate("+j+", "+(d.y+e.height)+")")};
Blockly.FieldDropdown.prototype.getOptions_=function(){return"function"==typeof this.menuGenerator_?this.menuGenerator_.call(this):this.menuGenerator_};Blockly.FieldDropdown.prototype.getValue=function(){for(var a=this.text_,b=this.getOptions_(),c=0;c<b.length;c++)if(b[c][0]==a)return b[c][1];throw'"'+a+'" not valid in dropdown.';};Blockly.FieldDropdown.prototype.setValue=function(a){for(var b=this.getOptions_(),c=0;c<b.length;c++)if(b[c][1]==a){this.setText(b[c][0]);return}this.setText(a)};
Blockly.FieldDropdown.hideMenu=function(){Blockly.FieldDropdown.svgGroup_.style.display="none"};Blockly.FieldLabel=function(a){this.sourceBlock_=null;this.textElement_=Blockly.createSvgElement("text",{"class":"blocklyText"},null);this.setText(a)};Blockly.FieldLabel.prototype=new Blockly.Field(null);Blockly.FieldLabel.prototype.EDITABLE=!1;Blockly.FieldLabel.prototype.init=function(a){if(this.sourceBlock_)throw"Text has already been initialized once.";this.sourceBlock_=a;a.getSvgRoot().appendChild(this.textElement_);this.textElement_.tooltip=this.sourceBlock_;Blockly.Tooltip&&Blockly.Tooltip.bindMouseEvents(this.textElement_)};
Blockly.FieldLabel.prototype.destroy=function(){this.textElement_.parentNode.removeChild(this.textElement_);this.textElement_=null};Blockly.FieldLabel.prototype.getRootElement=function(){return this.textElement_};Blockly.FieldLabel.prototype.render=function(){try{var a=this.textElement_.getBBox()}catch(b){return null}0==a.height&&(a.height=18);return a};Blockly.FieldLabel.prototype.setTooltip=function(a){this.textElement_.tooltip=a};Blockly.FieldTextInput=function(a,b){Blockly.Field.call(this,a);this.validationFunc_=b};Blockly.FieldTextInput.prototype=new Blockly.Field(null);Blockly.FieldTextInput.prototype.setText=function(a){if(this.validationFunc_){var b=this.validationFunc_(a);null!==b&&(a=b)}Blockly.Field.prototype.setText.call(this,a)};
Blockly.FieldTextInput.createDom=function(){var a=Blockly.createSvgElement("foreignObject",{"class":"blocklyHidden",height:22},null);Blockly.FieldTextInput.svgForeignObject_=a;var b=Blockly.svgDoc.createElement("body");b.className="blocklyMinimalBody";var c=Blockly.svgDoc.createElement("input");c.className="blocklyHtmlInput";c.style.border="none";c.style.outline="none";Blockly.FieldTextInput.htmlInput_=c;b.appendChild(c);a.appendChild(b);return a};Blockly.FieldTextInput.prototype.CURSOR="text";
Blockly.FieldTextInput.prototype.showEditor_=function(){if(window.opera){var a=window.prompt(Blockly.MSG_CHANGE_VALUE_TITLE,this.text_);this.validationFunc_&&(a=this.validationFunc_(a));null!==a&&this.setText(a)}else{a=Blockly.FieldTextInput.htmlInput_;a.value=a.defaultValue=this.text_;a.oldValue_=null;var b=Blockly.FieldTextInput.svgForeignObject_;b.style.display="block";var c=Blockly.getAbsoluteXY_(this.borderRect_);Blockly.RTL||b.setAttribute("x",c.x+1);-1!=window.navigator.userAgent.indexOf("Gecko/")?
b.setAttribute("y",c.y-1):b.setAttribute("y",c.y-3);a.focus();a.select();a.onBlurWrapper_=Blockly.bindEvent_(a,"blur",this,this.onHtmlInputBlur_);a.onKeyUpWrapper_=Blockly.bindEvent_(a,"keyup",this,this.onHtmlInputKeyUp_);a.onKeyPressWrapper_=Blockly.bindEvent_(a,"keypress",this,this.resizeEditor_);this.resizeEditor_();this.validate_()}};Blockly.FieldTextInput.prototype.onHtmlInputBlur_=function(){this.closeEditor_(!0)};
Blockly.FieldTextInput.prototype.onHtmlInputKeyUp_=function(a){13==a.keyCode?this.closeEditor_(!0):27==a.keyCode?this.closeEditor_(!1):(this.resizeEditor_(),this.validate_())};Blockly.FieldTextInput.prototype.validate_=function(){var a=!0,b=Blockly.FieldTextInput.htmlInput_;this.validationFunc_&&(a=this.validationFunc_(b.value));a?Blockly.removeClass_(b,"blocklyInvalidInput"):Blockly.addClass_(b,"blocklyInvalidInput")};
Blockly.FieldTextInput.prototype.resizeEditor_=function(){var a=Blockly.FieldTextInput.htmlInput_,b=a.value;if(b!==a.oldValue_){a.oldValue_=b;this.setText(b);var c=this.group_.getBBox(),b=Blockly.FieldTextInput.svgForeignObject_;b.setAttribute("width",c.width);a.style.width=c.width-2+"px";Blockly.RTL&&(a=Blockly.getAbsoluteXY_(this.group_),b.setAttribute("x",a.x-4))}};
Blockly.FieldTextInput.prototype.closeEditor_=function(a){var b=Blockly.FieldTextInput.htmlInput_;Blockly.unbindEvent_(b.onBlurWrapper_);Blockly.unbindEvent_(b.onKeyUpWrapper_);Blockly.unbindEvent_(b.onKeyPressWrapper_);a?(a=b.value,this.validationFunc_&&(a=this.validationFunc_(a),null===a&&(a=b.defaultValue))):a=b.defaultValue;this.setText(a);b.value="";b.defaultValue="";delete b.oldValue_;Blockly.FieldTextInput.svgForeignObject_.style.display="none";this.sourceBlock_.render()};Blockly.Flyout=function(){this.workspace_=new Blockly.Workspace(!1)};Blockly.Flyout.prototype.autoClose=!0;Blockly.Flyout.prototype.CORNER_RADIUS=8;Blockly.Flyout.prototype.createDom=function(){this.svgGroup_=Blockly.createSvgElement("g",{},null);this.svgBackground_=Blockly.createSvgElement("path",{"class":"blocklyFlyoutBackground"},this.svgGroup_);this.svgOptions_=Blockly.createSvgElement("g",{},this.svgGroup_);this.svgOptions_.appendChild(this.workspace_.createDom());return this.svgGroup_};
Blockly.Flyout.prototype.getMetrics=function(){if(!this.isVisible())return null;var a=this.height_-2*this.CORNER_RADIUS,b=this.width_;try{var c=this.svgOptions_.getBBox()}catch(d){c={height:0,y:0}}return{viewHeight:a,viewWidth:b,contentHeight:c.height+c.y,viewTop:-this.svgOptions_.scrollY,contentTop:0,absoluteTop:this.CORNER_RADIUS,absoluteLeft:0}};
Blockly.Flyout.prototype.setMetrics=function(a){var b=this.getMetrics();"number"==typeof a.y&&(this.svgOptions_.scrollY=-b.contentHeight*a.y-b.contentTop);this.svgOptions_.setAttribute("transform","translate(0,"+(this.svgOptions_.scrollY+b.absoluteTop)+")")};
Blockly.Flyout.prototype.init=function(a,b){this.targetWorkspace_=a;this.targetWorkspaceMetrics_=b;this.height_=this.width_=0;var c=this;new Blockly.Scrollbar(this.svgOptions_,function(){return c.getMetrics()},function(a){return c.setMetrics(a)},!1,!1);this.buttons_=[];this.position_();Blockly.bindEvent_(window,"resize",this,this.position_)};
Blockly.Flyout.prototype.position_=function(){var a=this.targetWorkspaceMetrics_();if(a){var b=this.width_-this.CORNER_RADIUS;Blockly.RTL&&(b*=-1);var c=["M "+(Blockly.RTL?this.width_:0)+",0"];c.push("h",b);c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,Blockly.RTL?0:1,Blockly.RTL?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS);c.push("v",Math.max(0,a.viewHeight-2*this.CORNER_RADIUS));c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,Blockly.RTL?0:1,Blockly.RTL?this.CORNER_RADIUS:
-this.CORNER_RADIUS,this.CORNER_RADIUS);c.push("h",-b);c.push("z");this.svgBackground_.setAttribute("d",c.join(" "));b=a.absoluteLeft;Blockly.RTL&&(b-=this.width_);this.svgGroup_.setAttribute("transform","translate("+b+","+a.absoluteTop+")");this.height_=a.viewHeight}};Blockly.Flyout.prototype.isVisible=function(){return"none"!=this.svgGroup_.style.display};
Blockly.Flyout.prototype.hide=function(){this.svgGroup_.style.display="none";for(var a=this.workspace_.getTopBlocks(!1),b=0,c;c=a[b];b++)c.destroy();for(b=0;a=this.buttons_[b];b++)Blockly.unbindEvent_(a.wrapper_),a.parentNode.removeChild(a);this.buttons_=[]};
Blockly.Flyout.prototype.show=function(a){var b=this.CORNER_RADIUS;this.svgGroup_.style.display="block";var c=[],d=[];if(a==Blockly.MSG_VARIABLE_CATEGORY)Blockly.Variables.flyoutCategory(c,d,b,this.workspace_);else if(a==Blockly.MSG_PROCEDURE_CATEGORY)Blockly.Procedures.flyoutCategory(c,d,b,this.workspace_);else for(var e=0,f;f=a[e];e++)f=new Blockly.Block(this.workspace_,f),f.initSvg(),c[e]=f,d[e]=2*b;for(var a=0,g=b,e=0;f=c[e];e++){f.isInFlyout=!0;Blockly.Comment&&f.setCommentText(null);f.render();
var h=f.getSvgRoot().getBBox();f.moveBy(Blockly.RTL?0:b+Blockly.BlockSvg.TAB_WIDTH,g);a=Math.max(a,h.width);g+=h.height+d[e];Blockly.bindEvent_(f.getSvgRoot(),"mousedown",null,Blockly.Flyout.createBlockFunc_(this,f))}a+=b+Blockly.BlockSvg.TAB_WIDTH+b/2+Blockly.Scrollbar.scrollbarThickness;for(e=0;f=c[e];e++)Blockly.RTL&&f.moveBy(a-b-Blockly.BlockSvg.TAB_WIDTH,0),h=f.getSvgRoot().getBBox(),d=f.getRelativeToSurfaceXY(),d=Blockly.createSvgElement("rect",{width:h.width,height:h.height,x:d.x+h.x,y:d.y+
h.y,"fill-opacity":0},null),this.svgOptions_.insertBefore(d,this.svgOptions_.firstChild),d.wrapper_=Blockly.bindEvent_(d,"mousedown",null,Blockly.Flyout.createBlockFunc_(this,f)),this.buttons_[e]=d;this.width_=a;Blockly.fireUiEvent(Blockly.svgDoc,window,"resize")};
Blockly.Flyout.createBlockFunc_=function(a,b){return function(c){if(2!=c.button){var d=Blockly.Xml.blockToDom_(b),d=Blockly.Xml.domToBlock_(a.targetWorkspace_,d),e=Blockly.getAbsoluteXY_(b.getSvgRoot()),f=Blockly.getAbsoluteXY_(a.targetWorkspace_.getCanvas());d.moveBy(e.x-f.x,e.y-f.y);d.render();a.autoClose&&a.hide();d.onMouseDown_(c)}}};Blockly.Generator={};Blockly.Generator.NAME_TYPE="generated_function";Blockly.Generator.languages={};
Blockly.Generator.get=function(a){a in Blockly.Generator.languages||(Blockly.Generator.languages[a]={blockToCode:function(b){if(!b)return"";var c=this[b.type];if(!c)throw'Language "'+a+'" does not know how to generate code for block type "'+b.type+'".';c=c.call(b);return c instanceof Array?[this.scrub_(b,c[0]),c[1]]:this.scrub_(b,c)},valueToCode:function(a,c,d){c=a.getInputTargetBlock(c);if(!c)return"";a=this.blockToCode(c);if(!(a instanceof Array))throw'Expecting tuple from value block "'+c.type+
'".';c=a[0];d<=a[1]&&(c="("+c+")");return c},statementToCode:function(a,c){var d=a.getInputTargetBlock(c),e=this.blockToCode(d);if("string"!=typeof e)throw'Expecting code from statement block "'+d.type+'".';e&&(e=Blockly.Generator.prefixLines(e,"  "));return e}});return Blockly.Generator.languages[a]};
Blockly.Generator.workspaceToCode=function(a){var b=[],a=Blockly.Generator.get(a);a.init();for(var c=Blockly.mainWorkspace.getTopBlocks(!0),d=0,e;e=c[d];d++){var f=a.blockToCode(e,!0);f instanceof Array&&(f=f[0]);e.outputConnection&&a.scrubNakedValue&&(f=a.scrubNakedValue(f));b.push(f)}b=b.join("\n");b=a.finish(b);b=b.replace(/^\s+\n/,"");b=b.replace(/\n\s+$/,"\n");return b=b.replace(/[ \t]+\n/g,"\n")};Blockly.Generator.prefixLines=function(a,b){return b+a.replace(/\n(.)/g,"\n"+b+"$1")};
Blockly.Generator.allNestedComments=function(a){for(var b=[],a=a.getDescendants(),c=0;c<a.length;c++){var d=a[c].getCommentText();d&&b.push(d)}b.length&&b.push("");return b.join("\n")};Blockly.inject=function(a,b){b&&Blockly.parseOptions_(b);Blockly.createDom_(a);Blockly.init_()};Blockly.parseOptions_=function(a){Blockly.RTL=!!a.rtl;Blockly.editable=!a.readOnly;Blockly.pathToBlockly=a.path||"./"};
Blockly.createDom_=function(a){for(var b=a;b.parentNode;)b=b.parentNode;Blockly.svgDoc=b;var c=b.createElement("link");c.setAttribute("href",Blockly.pathToBlockly+"blockly.css");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("onload","Blockly.cssLoaded()");b=b.head||b.getElementsByTagName("head")[0];if(!b)throw"No head in document.";b.appendChild(c);var c=Blockly.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml",
"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1","class":"blocklySvg"},null),b=Blockly.createSvgElement("defs",{},c),d,e;d=Blockly.createSvgElement("filter",{id:"blocklyEmboss"},b);Blockly.createSvgElement("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:1,result:"blur"},d);e=Blockly.createSvgElement("feSpecularLighting",{"in":"blur",surfaceScale:1,specularConstant:0.5,specularExponent:10,"lighting-color":"white",result:"specOut"},d);Blockly.createSvgElement("fePointLight",{x:-5E3,y:-1E4,
z:2E4},e);Blockly.createSvgElement("feComposite",{"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},d);Blockly.createSvgElement("feComposite",{"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},d);d=Blockly.createSvgElement("filter",{id:"blocklyTrashcanShadowFilter"},b);Blockly.createSvgElement("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:2,result:"blur"},d);Blockly.createSvgElement("feOffset",{"in":"blur",dx:1,dy:1,result:"offsetBlur"},d);d=Blockly.createSvgElement("feMerge",
{},d);Blockly.createSvgElement("feMergeNode",{"in":"offsetBlur"},d);Blockly.createSvgElement("feMergeNode",{"in":"SourceGraphic"},d);d=Blockly.createSvgElement("filter",{id:"blocklyShadowFilter"},b);Blockly.createSvgElement("feGaussianBlur",{stdDeviation:2},d);Blockly.mainWorkspace=new Blockly.Workspace(Blockly.editable);c.appendChild(Blockly.mainWorkspace.createDom());c.appendChild(Blockly.FieldTextInput.createDom());Blockly.commentCanvas=Blockly.createSvgElement("g",{},c);Blockly.Toolbox&&Blockly.editable&&
c.appendChild(Blockly.Toolbox.createDom());Blockly.Mutator&&Blockly.editable&&c.appendChild(Blockly.Mutator.createDom());Blockly.Tooltip&&c.appendChild(Blockly.Tooltip.createDom());Blockly.editable&&c.appendChild(Blockly.FieldDropdown.createDom());Blockly.ContextMenu&&c.appendChild(Blockly.ContextMenu.createDom());a.appendChild(c);Blockly.svg=c;Blockly.svgResize()};
Blockly.init_=function(){var a=Blockly.svgDoc;Blockly.bindEvent_(window,"resize",a,Blockly.svgResize);Blockly.bindEvent_(Blockly.svg,"mousedown",null,Blockly.onMouseDown_);Blockly.bindEvent_(a,"mouseup",null,Blockly.onMouseUp_);Blockly.bindEvent_(Blockly.svg,"mousemove",null,Blockly.onMouseMove_);Blockly.bindEvent_(Blockly.svg,"contextmenu",null,Blockly.onContextMenu_);Blockly.bindEvent_(a,"keydown",null,Blockly.onKeyDown_);Blockly.editable&&(Blockly.Toolbox&&Blockly.Toolbox.init(),Blockly.Mutator&&
Blockly.Mutator.init());Blockly.mainWorkspace.addTrashcan(Blockly.getMainWorkspaceMetrics);Blockly.mainWorkspace.scrollbar=new Blockly.ScrollbarPair(Blockly.mainWorkspace.getCanvas(),Blockly.getMainWorkspaceMetrics,this.setMainWorkspaceMetrics);Blockly.loadAudio_("click");Blockly.loadAudio_("delete")};Blockly.Mutator=function(a){this.block_=null;this.quarkNames_=a};Blockly.Mutator.ICON_SIZE=16;Blockly.Mutator.isOpen=!1;Blockly.Mutator.prototype.destroy=function(){this.iconGroup_.parentNode.removeChild(this.iconGroup_);this.block_=this.iconGroup_=null};
Blockly.Mutator.prototype.createIcon=function(){var a=Blockly.Mutator.ICON_SIZE/8;this.iconGroup_=Blockly.createSvgElement("g",{},null);this.block_.editable&&this.iconGroup_.setAttribute("class","blocklyIconGroup");var b=Blockly.createSvgElement("rect",{"class":"blocklyIconShield",width:8*a,height:8*a,rx:2*a,ry:2*a},this.iconGroup_);if(!Blockly.Mutator.crossPath_){var c=[];c.push("M",3.5*a+","+3.5*a);c.push("v",-2*a,"h",a);c.push("v",2*a,"h",2*a);c.push("v",a,"h",-2*a);c.push("v",2*a,"h",-a);c.push("v",
-2*a,"h",-2*a);c.push("v",-a,"z");Blockly.Mutator.crossPath_=c.join(" ")}a=Blockly.createSvgElement("path",{"class":"blocklyMutatorMark",d:Blockly.Mutator.crossPath_},this.iconGroup_);this.block_.getSvgRoot().appendChild(this.iconGroup_);this.block_.editable&&Blockly.bindEvent_(this.iconGroup_,"mouseup",this,this.onMouseUp_);Blockly.Tooltip&&(this.tooltip=Blockly.MSG_MUTATOR_TOOLTIP,b.tooltip=this,a.tooltip=this,Blockly.Tooltip.bindMouseEvents(b),Blockly.Tooltip.bindMouseEvents(a))};
Blockly.Mutator.prototype.renderIcon=function(a){if(this.block_.collapsed)return this.iconGroup_.setAttribute("display","none"),0;this.iconGroup_.setAttribute("display","block");var b=Blockly.Mutator.ICON_SIZE;Blockly.RTL&&(a-=b);this.iconGroup_.setAttribute("transform","translate("+a+", 5)");return b};Blockly.Mutator.prototype.onMouseUp_=function(a){2!=a.button&&2!=Blockly.Block.dragMode_&&Blockly.Mutator.openDialog_(this.block_)};
Blockly.Mutator.createDom=function(){var a=Blockly.createSvgElement("g",{"class":"blocklyHidden"},null);Blockly.Mutator.svgGroup_=a;Blockly.Mutator.svgShadow_=Blockly.createSvgElement("rect",{"class":"blocklyScreenShadow"},a);Blockly.Mutator.svgDialog_=Blockly.createSvgElement("svg",{},a);Blockly.Mutator.svgBackground_=Blockly.createSvgElement("rect",{"class":"blocklyMutatorBackground",height:"100%",width:"100%"},Blockly.Mutator.svgDialog_);Blockly.Mutator.svgHeader_=Blockly.createSvgElement("text",
{"class":"blocklyHeader",y:30},Blockly.Mutator.svgDialog_);var b=Blockly.svgDoc.createTextNode(Blockly.MSG_MUTATOR_HEADER);Blockly.Mutator.svgHeader_.appendChild(b);Blockly.Mutator.helpButton_=new Blockly.Mutator.Button(Blockly.MSG_HELP,!1,Blockly.Mutator.showHelp_);Blockly.Mutator.cancelButton_=new Blockly.Mutator.Button(Blockly.MSG_MUTATOR_CANCEL,!1,Blockly.Mutator.closeDialog);Blockly.Mutator.changeButton_=new Blockly.Mutator.Button(Blockly.MSG_MUTATOR_CHANGE,!0,Blockly.Mutator.saveDialog_);Blockly.Mutator.svgDialog_.appendChild(Blockly.Mutator.helpButton_.createDom());
Blockly.Mutator.svgDialog_.appendChild(Blockly.Mutator.cancelButton_.createDom());Blockly.Mutator.svgDialog_.appendChild(Blockly.Mutator.changeButton_.createDom());Blockly.Mutator.workspace_=new Blockly.Workspace(!0);Blockly.Mutator.flyout_=new Blockly.Flyout;Blockly.Mutator.flyout_.autoClose=!1;Blockly.Mutator.svgDialog_.appendChild(Blockly.Mutator.flyout_.createDom());Blockly.Mutator.svgDialog_.appendChild(Blockly.Mutator.workspace_.createDom());return a};
Blockly.Mutator.init=function(){Blockly.Mutator.helpButton_.init();Blockly.Mutator.cancelButton_.init();Blockly.Mutator.changeButton_.init();Blockly.Mutator.headerLength_=Blockly.Mutator.svgHeader_.getComputedTextLength();Blockly.Mutator.helpLength_=Blockly.Mutator.helpButton_.getBBox().width;Blockly.Mutator.cancelLength_=Blockly.Mutator.cancelButton_.getBBox().width;var a=Blockly.Mutator.changeButton_.getBBox();Blockly.Mutator.changeLength_=a.width;Blockly.Mutator.workspaceLeft_=0;Blockly.Mutator.workspaceTop_=
a.height+10;Blockly.Mutator.workspace_.addTrashcan(Blockly.Mutator.getWorkspaceMetrics_);Blockly.Mutator.flyout_.init(Blockly.Mutator.workspace_,Blockly.Mutator.getFlyoutMetrics_)};
Blockly.Mutator.position_=function(){var a=Blockly.svgSize();Blockly.Mutator.svgShadow_.setAttribute("width",a.width);Blockly.Mutator.svgShadow_.setAttribute("height",a.height);var b=Math.max(0,a.width-80),a=Math.max(0,a.height-80);Blockly.Mutator.svgDialog_.setAttribute("x",40);Blockly.Mutator.svgDialog_.setAttribute("y",40);Blockly.Mutator.svgDialog_.setAttribute("width",b);Blockly.Mutator.svgDialog_.setAttribute("height",a);Blockly.Mutator.svgDialog_.setAttribute("viewBox","0 0 "+b+" "+a);var c=
Blockly.ContextMenu.X_PADDING;Blockly.RTL&&(c=b-Blockly.Mutator.headerLength_-c);Blockly.Mutator.svgHeader_.setAttribute("x",c);var d;Blockly.RTL?(d=Blockly.ContextMenu.X_PADDING,Blockly.Mutator.changeButton_.setLocation(d,5),d+=Blockly.Mutator.changeLength_+Blockly.ContextMenu.X_PADDING,Blockly.Mutator.cancelButton_.setLocation(d,5),d+=Blockly.Mutator.cancelLength_+Blockly.ContextMenu.X_PADDING,Blockly.Mutator.helpButton_.setLocation(d,5),d+=Blockly.Mutator.helpLength_,d=c-d):(d=b-Blockly.ContextMenu.X_PADDING-
Blockly.Mutator.changeLength_,Blockly.Mutator.changeButton_.setLocation(d,5),d-=Blockly.ContextMenu.X_PADDING+Blockly.Mutator.cancelLength_,Blockly.Mutator.cancelButton_.setLocation(d,5),d-=Blockly.ContextMenu.X_PADDING+Blockly.Mutator.helpLength_,Blockly.Mutator.helpButton_.setLocation(d,5),Blockly.Mutator.helpButton_.setVisible(0<d),d-=c+Blockly.Mutator.headerLength_);Blockly.Mutator.svgHeader_.style.display=0<d?"block":"none";Blockly.Mutator.workspaceWidth_=b;Blockly.Mutator.workspaceHeight_=a-
Blockly.Mutator.workspaceTop_};Blockly.Mutator.getFlyoutMetrics_=function(){if(!Blockly.Mutator.isOpen)return null;var a=Blockly.Mutator.workspaceLeft_;Blockly.RTL&&(a+=Blockly.Mutator.workspaceWidth_);return{viewHeight:Blockly.Mutator.workspaceHeight_,absoluteTop:Blockly.Mutator.workspaceTop_,absoluteLeft:a}};
Blockly.Mutator.getWorkspaceMetrics_=function(){return!Blockly.Mutator.isOpen?null:{viewHeight:Blockly.Mutator.workspaceHeight_,viewWidth:Blockly.Mutator.workspaceWidth_,absoluteTop:Blockly.Mutator.workspaceTop_,absoluteLeft:Blockly.Mutator.workspaceLeft_}};Blockly.Mutator.showHelp_=function(){Blockly.Mutator.sourceBlock_.showHelp_()};
Blockly.Mutator.openDialog_=function(a){Blockly.Mutator.isOpen=!0;Blockly.Mutator.sourceBlock_=a;Blockly.Mutator.helpButton_.setVisible(!!a.helpUrl);Blockly.removeClass_(Blockly.Mutator.svgGroup_,"blocklyHidden");Blockly.Mutator.position_();Blockly.fireUiEvent(Blockly.svgDoc,window,"resize");Blockly.Mutator.resizeWrapper_=Blockly.bindEvent_(window,"resize",null,Blockly.Mutator.position_);Blockly.Mutator.flyout_.show(a.mutator.quarkNames_);Blockly.Mutator.rootBlock_=a.decompose(Blockly.Mutator.workspace_);
for(var a=Blockly.Mutator.rootBlock_.getDescendants(),b=0,c;c=a[b];b++)c.render();Blockly.Mutator.rootBlock_.editable=!1;a=150;Blockly.RTL&&(a=Blockly.Mutator.workspaceWidth_-a);Blockly.Mutator.rootBlock_.moveBy(a,50)};
Blockly.Mutator.closeDialog=function(){Blockly.Mutator.isOpen=!1;Blockly.addClass_(Blockly.Mutator.svgGroup_,"blocklyHidden");Blockly.unbindEvent_(Blockly.Mutator.resizeWrapper_);Blockly.Mutator.resizeWrapper_=null;Blockly.Mutator.flyout_.hide();for(var a=Blockly.Mutator.workspace_.getTopBlocks(!1),b=0,c;c=a[b];b++)c.destroy();Blockly.Mutator.sourceBlock_=null;Blockly.Mutator.rootBlock_=null};Blockly.Mutator.saveDialog_=function(){Blockly.Mutator.sourceBlock_.compose(Blockly.Mutator.rootBlock_);Blockly.Mutator.closeDialog()};
Blockly.Mutator.Button=function(a,b,c){this.caption_=a;this.launch_=b;this.action_=c};Blockly.Mutator.Button.prototype.destroy=function(){this.onClickWrapper_&&(Blockly.unbindEvent_(this.onClickWrapper_),this.onClickWrapper_=null);this.svgGroup_.parentNode.removeChild(this.svgGroup_);this.svgText_=this.svgBackground_=this.svgShadow_=this.svgGroup_=null};
Blockly.Mutator.Button.prototype.createDom=function(){var a="blocklyButton";this.launch_&&(a+=" blocklyLaunchButton");this.svgGroup_=Blockly.createSvgElement("g",{"class":a},null);this.svgShadow_=Blockly.createSvgElement("rect",{rx:5,ry:5,x:2,y:2,"class":"blocklyButtonShadow"},this.svgGroup_);this.svgBackground_=Blockly.createSvgElement("rect",{rx:5,ry:5,"class":"blocklyButtonBackground"},this.svgGroup_);this.svgText_=Blockly.createSvgElement("text",{"class":"blocklyButtonText"},this.svgGroup_);this.svgText_.appendChild(Blockly.svgDoc.createTextNode(this.caption_));
this.onClickWrapper_=null;this.action_&&(this.onClickWrapper_=Blockly.bindEvent_(this.svgGroup_,"mouseup",this,this.action_));return this.svgGroup_};
Blockly.Mutator.Button.prototype.init=function(){var a=Blockly.ContextMenu.X_PADDING;try{var b=this.svgText_.getBBox()}catch(c){b={height:0,width:0}}this.svgShadow_.setAttribute("width",b.width+2*a);this.svgShadow_.setAttribute("height",b.height+10);this.svgBackground_.setAttribute("width",b.width+2*a);this.svgBackground_.setAttribute("height",b.height+10);this.svgText_.setAttribute("x",a);this.svgText_.setAttribute("y",b.height)};
Blockly.Mutator.Button.prototype.getBBox=function(){try{return this.svgGroup_.getBBox()}catch(a){return{height:0,width:0}}};Blockly.Mutator.Button.prototype.setLocation=function(a,b){this.svgGroup_.setAttribute("transform","translate("+a+","+b+")")};Blockly.Mutator.Button.prototype.setVisible=function(a){this.svgGroup_.setAttribute("display",a?"block":"none")};Blockly.Names=function(a){this.reservedDict_={};if(a)for(var b=0;b<a.length;b++)this.reservedDict_[Blockly.Names.PREFIX_+a[b]]=!0;this.reset()};Blockly.Names.PREFIX_="v_";Blockly.Names.prototype.reset=function(){this.db_={};this.dbReverse_={}};Blockly.Names.prototype.getName=function(a,b){var c=Blockly.Names.PREFIX_+a.toLowerCase()+"X"+b;return c in this.db_?this.db_[c]:this.getDistinctName(a,b)};
Blockly.Names.prototype.getDistinctName=function(a,b){for(var c=this.safeName_(a),d="";this.dbReverse_[Blockly.Names.PREFIX_+c+d]||Blockly.Names.PREFIX_+c+d in this.reservedDict_;)d=d?d+1:2;c+=d;this.db_[Blockly.Names.PREFIX_+a.toLowerCase()+"X"+b]=c;this.dbReverse_[Blockly.Names.PREFIX_+c]=!0;return c};Blockly.Names.prototype.safeName_=function(a){a?(a=encodeURI(a.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(a.charAt(0))&&(a="my_"+a)):a="unnamed";return a};
Blockly.Names.equals=function(a,b){return a.toLowerCase()==b.toLowerCase()};Blockly.Procedures={};Blockly.Procedures.NAME_TYPE="procedure";Blockly.Procedures.allProcedures=function(){for(var a=Blockly.mainWorkspace.getAllBlocks(!1),b=[],c=[],d=0;d<a.length;d++){var e=a[d].getProcedureDef;e&&(e=e.call(a[d]))&&(e[1]?b.push(e[0]):c.push(e[0]))}c.sort(Blockly.caseInsensitiveComparator);b.sort(Blockly.caseInsensitiveComparator);return[c,b]};
Blockly.Procedures.findLegalName=function(a,b){if(!b.workspace.editable)return a;for(;!Blockly.Procedures.isLegalName(a,b.workspace,b);)var c=a.match(/^(.*?)(\d+)$/),a=c?c[1]+(parseInt(c[2],10)+1):a+"2";return a};Blockly.Procedures.isLegalName=function(a,b,c){for(var a=a.toLowerCase(),b=b.getAllBlocks(!1),d=0;d<b.length;d++)if(b[d]!=c){var e=b[d].getProcedureDef;if(e&&e.call(b[d])[0].toLowerCase()==a)return!1}return!0};
Blockly.Procedures.rename=function(a){if(!this.sourceBlock_.editable)return a;a=a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");if(!a)return null;for(var a=Blockly.Procedures.findLegalName(a,this.sourceBlock_),b=this.sourceBlock_.workspace.getAllBlocks(!1),c=0;c<b.length;c++){var d=b[c].renameProcedure;d&&d.call(b[c],this.text_,a)}window.setTimeout(Blockly.Procedures.refreshFlyoutCategory,1);return a};
Blockly.Procedures.flyoutCategory=function(a,b,c,d){if(Blockly.Language.procedures_defnoreturn){var e=new Blockly.Block(d,"procedures_defnoreturn");e.initSvg();a.push(e);b.push(2*c)}Blockly.Language.procedures_defreturn&&(e=new Blockly.Block(d,"procedures_defreturn"),e.initSvg(),a.push(e),b.push(2*c));var e=Blockly.Procedures.allProcedures(),f=e[0],g=e[1];if(Blockly.Language.procedures_callnoreturn)for(var h=0;h<f.length;h++)e=new Blockly.Block(d,"procedures_callnoreturn"),e.setTitleText(f[h],"NAME"),
e.initSvg(),a.push(e),b.push(2*c);if(Blockly.Language.procedures_callreturn)for(h=0;h<g.length;h++)e=new Blockly.Block(d,"procedures_callreturn"),e.setTitleText(g[h],"NAME"),e.initSvg(),a.push(e),b.push(2*c)};Blockly.Procedures.refreshFlyoutCategory=function(){Blockly.Toolbox&&(Blockly.Toolbox.flyout_.isVisible()&&Blockly.Toolbox.selectedOption_.cat==Blockly.MSG_PROCEDURE_CATEGORY)&&(Blockly.Toolbox.flyout_.hide(),Blockly.Toolbox.flyout_.show(Blockly.MSG_PROCEDURE_CATEGORY))};
Blockly.Procedures.destroyCallers=function(a,b){for(var a=a.toLowerCase(),c=b.getAllBlocks(!1),d=0;d<c.length;d++){var e=c[d].getProcedureCall;e&&(e=e.call(c[d]))&&e.toLowerCase()==a&&c[d].destroy(!0)}window.setTimeout(Blockly.Procedures.refreshFlyoutCategory,1)};Blockly.ScrollbarPair=function(a,b,c){this.element_=a;this.getMetrics_=b;this.setMetrics_=c;this.oldHostMetrics_={};this.hScroll=new Blockly.Scrollbar(a,b,c,!0,!0);this.vScroll=new Blockly.Scrollbar(a,b,c,!1,!0);this.corner_=this.addCorner_(a);this.resize();var d=this;Blockly.bindEvent_(window,"resize",d,function(){d.resize()})};
Blockly.ScrollbarPair.prototype.addCorner_=function(a){var b=Blockly.createSvgElement("rect",{height:Blockly.Scrollbar.scrollbarThickness,width:Blockly.Scrollbar.scrollbarThickness,style:"fill: #fff"},null);Blockly.Scrollbar.insertAfter_(b,a);return b};
Blockly.ScrollbarPair.prototype.resize=function(){var a=this.getMetrics_();if(a){var b=!1,c=!1;if(this.oldHostMetrics_.viewWidth!=a.viewWidth||this.oldHostMetrics_.viewHeight!=a.viewHeight||this.oldHostMetrics_.absoluteTop!=a.absoluteTop||this.oldHostMetrics_.absoluteLeft!=a.absoluteLeft)c=b=!0;else{if(this.oldHostMetrics_.contentWidth!=a.contentWidth||this.oldHostMetrics_.viewLeft!=a.viewLeft||this.oldHostMetrics_.contentLeft!=a.contentLeft)b=!0;if(this.oldHostMetrics_.contentHeight!=a.contentHeight||
this.oldHostMetrics_.viewTop!=a.viewTop||this.oldHostMetrics_.contentTop!=a.contentTop)c=!0}b&&this.hScroll.resize(a);c&&this.vScroll.resize(a);(this.oldHostMetrics_.viewWidth!=a.viewWidth||this.oldHostMetrics_.absoluteLeft!=a.absoluteLeft)&&this.corner_.setAttribute("x",this.vScroll.xCoordinate);(this.oldHostMetrics_.viewHeight!=a.viewHeight||this.oldHostMetrics_.absoluteTop!=a.absoluteTop)&&this.corner_.setAttribute("y",this.hScroll.yCoordinate);this.oldHostMetrics_=a}};
Blockly.ScrollbarPair.prototype.set=function(a,b){if(Blockly.Scrollbar===Blockly.ScrollbarNative){this.hScroll.set(a,!1);this.vScroll.set(b,!1);var c={};c.x=this.hScroll.outerDiv_.scrollLeft/this.hScroll.innerImg_.offsetWidth||0;c.y=this.vScroll.outerDiv_.scrollTop/this.vScroll.innerImg_.offsetHeight||0;this.setMetrics_(c)}else this.hScroll.set(a,!0),this.vScroll.set(b,!0)};
Blockly.ScrollbarNative=function(a,b,c,d,e){this.element_=a;this.getMetrics_=b;this.setMetrics_=c;this.pair_=e||!1;this.horizontal_=d;this.createDom_(a);if(null!==d){Blockly.ScrollbarNative.scrollbarThickness||Blockly.ScrollbarNative.measureScrollbarThickness_(a);d?(this.foreignObject_.setAttribute("height",Blockly.ScrollbarNative.scrollbarThickness),this.outerDiv_.style.height=Blockly.ScrollbarNative.scrollbarThickness+"px",this.outerDiv_.style.overflowX="scroll",this.outerDiv_.style.overflowY="hidden",
this.innerImg_.style.height="1px"):(this.foreignObject_.setAttribute("width",Blockly.ScrollbarNative.scrollbarThickness),this.outerDiv_.style.width=Blockly.ScrollbarNative.scrollbarThickness+"px",this.outerDiv_.style.overflowX="hidden",this.outerDiv_.style.overflowY="scroll",this.innerImg_.style.width="1px");var f=this;this.onScrollWrapper_=Blockly.bindEvent_(this.outerDiv_,"scroll",f,function(){f.onScroll_()});Blockly.bindEvent_(this.foreignObject_,"mousedown",null,Blockly.noEvent);this.pair_||(this.resize(),
Blockly.bindEvent_(window,"resize",f,function(){f.resize()}))}};
Blockly.ScrollbarNative.prototype.resize=function(a){if(!a&&(a=this.getMetrics_(),!a))return;if(this.horizontal_){var b=a.viewWidth;this.pair_?b-=Blockly.ScrollbarNative.scrollbarThickness:this.setVisible(b<a.contentHeight);this.ratio_=b/a.viewWidth;var c=this.ratio_*a.contentWidth,d=(a.viewLeft-a.contentLeft)*this.ratio_;this.outerDiv_.style.width=b+"px";this.innerImg_.style.width=c+"px";this.xCoordinate=a.absoluteLeft;this.pair_&&Blockly.RTL&&(this.xCoordinate+=Blockly.ScrollbarNative.scrollbarThickness);
this.yCoordinate=a.absoluteTop+a.viewHeight-Blockly.ScrollbarNative.scrollbarThickness;this.foreignObject_.setAttribute("x",this.xCoordinate);this.foreignObject_.setAttribute("y",this.yCoordinate);this.foreignObject_.setAttribute("width",Math.max(0,b));this.outerDiv_.scrollLeft=Math.round(d)}else b=a.viewHeight,this.pair_?b-=Blockly.ScrollbarNative.scrollbarThickness:this.setVisible(b<a.contentHeight),this.ratio_=b/a.viewHeight,c=this.ratio_*a.contentHeight,d=(a.viewTop-a.contentTop)*this.ratio_,
this.outerDiv_.style.height=b+"px",this.innerImg_.style.height=c+"px",this.xCoordinate=a.absoluteLeft,Blockly.RTL||(this.xCoordinate+=a.viewWidth-Blockly.ScrollbarNative.scrollbarThickness),this.yCoordinate=a.absoluteTop,this.foreignObject_.setAttribute("x",this.xCoordinate),this.foreignObject_.setAttribute("y",this.yCoordinate),this.foreignObject_.setAttribute("height",Math.max(0,b)),this.outerDiv_.scrollTop=Math.round(d)};
Blockly.ScrollbarNative.prototype.createDom_=function(a){this.foreignObject_=Blockly.createSvgElement("foreignObject",{},null);var b=Blockly.svgDoc.createElementNS(Blockly.HTML_NS,"body");b.setAttribute("xmlns",Blockly.HTML_NS);b.setAttribute("class","blocklyMinimalBody");var c=Blockly.svgDoc.createElementNS(Blockly.HTML_NS,"div");this.outerDiv_=c;var d=Blockly.svgDoc.createElementNS(Blockly.HTML_NS,"img");d.setAttribute("src",Blockly.pathToBlockly+"1x1.gif");this.innerImg_=d;c.appendChild(d);b.appendChild(c);
this.foreignObject_.appendChild(b);Blockly.Scrollbar.insertAfter_(this.foreignObject_,a)};Blockly.ScrollbarNative.prototype.isVisible=function(){return"none"!=this.foreignObject_.style.display};Blockly.ScrollbarNative.prototype.setVisible=function(a){if(a!=this.isVisible()){if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";a?(this.foreignObject_.style.display="block",this.getMetrics_()):(this.setMetrics_({x:0,y:0}),this.foreignObject_.style.display="none")}};
Blockly.ScrollbarNative.prototype.onScroll_=function(){var a={};this.horizontal_?a.x=this.outerDiv_.scrollLeft/this.innerImg_.offsetWidth||0:a.y=this.outerDiv_.scrollTop/this.innerImg_.offsetHeight||0;this.setMetrics_(a)};
Blockly.ScrollbarNative.prototype.set=function(a,b){if(!b){var c=this.onScrollWrapper_[0][2];Blockly.unbindEvent_(this.onScrollWrapper_)}this.horizontal_?this.outerDiv_.scrollLeft=a*this.ratio_:this.outerDiv_.scrollTop=a*this.ratio_;b||(this.onScrollWrapper_=Blockly.bindEvent_(this.outerDiv_,"scroll",this,c))};Blockly.ScrollbarNative.scrollbarThickness=0;
Blockly.ScrollbarNative.measureScrollbarThickness_=function(a){var b=new Blockly.ScrollbarNative(a,null,null,null,!1);b.outerDiv_.style.width="100px";b.outerDiv_.style.height="100px";b.innerImg_.style.width="100%";b.innerImg_.style.height="200px";b.foreignObject_.setAttribute("width",1);b.foreignObject_.setAttribute("height",1);b.outerDiv_.style.overflowY="scroll";var c=b.innerImg_.offsetWidth;b.outerDiv_.style.overflowY="hidden";var d=b.innerImg_.offsetWidth;a.parentNode.removeChild(b.foreignObject_);
a=d-c;0>=a&&(a=15);Blockly.ScrollbarNative.scrollbarThickness=a};
Blockly.ScrollbarSvg=function(a,b,c,d,e){this.element_=a;this.getMetrics_=b;this.setMetrics_=c;this.pair_=e||!1;this.horizontal_=d;this.createDom_(a);d?(this.svgBackground_.setAttribute("height",Blockly.ScrollbarSvg.scrollbarThickness),this.svgKnob_.setAttribute("height",Blockly.ScrollbarSvg.scrollbarThickness-6),this.svgKnob_.setAttribute("y",3)):(this.svgBackground_.setAttribute("width",Blockly.ScrollbarSvg.scrollbarThickness),this.svgKnob_.setAttribute("width",Blockly.ScrollbarSvg.scrollbarThickness-
6),this.svgKnob_.setAttribute("x",3));var f=this;this.pair_||(this.resize(),Blockly.bindEvent_(window,"resize",f,function(){f.resize()}));Blockly.bindEvent_(this.svgBackground_,"mousedown",f,f.onMouseDownBar_);Blockly.bindEvent_(this.svgKnob_,"mousedown",f,f.onMouseDownKnob_)};
Blockly.ScrollbarSvg.prototype.resize=function(a){if(!a&&(a=this.getMetrics_(),!a))return;if(this.horizontal_){var b=a.viewWidth;this.pair_?b-=Blockly.ScrollbarSvg.scrollbarThickness:this.setVisible(b<a.contentHeight);this.ratio_=b/a.contentWidth;if(-Infinity===this.ratio_||Infinity===this.ratio_||isNaN(this.ratio_))this.ratio_=0;var c=a.viewWidth*this.ratio_,d=(a.viewLeft-a.contentLeft)*this.ratio_;this.svgKnob_.setAttribute("width",Math.max(0,c));this.xCoordinate=a.absoluteLeft;this.pair_&&Blockly.RTL&&
(this.xCoordinate+=a.absoluteLeft+Blockly.ScrollbarSvg.scrollbarThickness);this.yCoordinate=a.absoluteTop+a.viewHeight-Blockly.ScrollbarSvg.scrollbarThickness;this.svgGroup_.setAttribute("transform","translate("+this.xCoordinate+", "+this.yCoordinate+")");this.svgBackground_.setAttribute("width",Math.max(0,b));this.svgKnob_.setAttribute("x",this.constrainKnob_(d))}else{b=a.viewHeight;this.pair_?b-=Blockly.ScrollbarSvg.scrollbarThickness:this.setVisible(b<a.contentHeight);this.ratio_=b/a.contentHeight;
if(-Infinity===this.ratio_||Infinity===this.ratio_||isNaN(this.ratio_))this.ratio_=0;c=a.viewHeight*this.ratio_;d=(a.viewTop-a.contentTop)*this.ratio_;this.svgKnob_.setAttribute("height",Math.max(0,c));this.xCoordinate=a.absoluteLeft;Blockly.RTL||(this.xCoordinate+=a.viewWidth-Blockly.ScrollbarSvg.scrollbarThickness);this.yCoordinate=a.absoluteTop;this.svgGroup_.setAttribute("transform","translate("+this.xCoordinate+", "+this.yCoordinate+")");this.svgBackground_.setAttribute("height",Math.max(0,b));
this.svgKnob_.setAttribute("y",this.constrainKnob_(d))}this.onScroll_()};
Blockly.ScrollbarSvg.prototype.createDom_=function(a){this.svgGroup_=Blockly.createSvgElement("g",{},null);this.svgBackground_=Blockly.createSvgElement("rect",{"class":"blocklyScrollbarBackground"},this.svgGroup_);var b=Math.floor((Blockly.ScrollbarSvg.scrollbarThickness-6)/2);this.svgKnob_=Blockly.createSvgElement("rect",{"class":"blocklyScrollbarKnob",rx:b,ry:b},this.svgGroup_);Blockly.Scrollbar.insertAfter_(this.svgGroup_,a)};Blockly.ScrollbarSvg.prototype.isVisible=function(){return"none"!=this.svgGroup_.getAttribute("display")};
Blockly.ScrollbarSvg.prototype.setVisible=function(a){if(a!=this.isVisible()){if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";a?this.svgGroup_.setAttribute("display","block"):(this.setMetrics_({x:0,y:0}),this.svgGroup_.setAttribute("display","none"))}};
Blockly.ScrollbarSvg.prototype.onMouseDownBar_=function(a){Blockly.hideChaff(!0);if(2!=a.button){Blockly.svgResize();var b=Blockly.svgSize(),b=this.horizontal_?a.x-b.left:a.y-b.top,c=Blockly.getAbsoluteXY_(this.svgKnob_),c=this.horizontal_?c.x:c.y,d=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"width":"height")),e=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"x":"y")),f=0.95*d;b<=c?e-=f:b>=c+d&&(e+=f);this.svgKnob_.setAttribute(this.horizontal_?"x":"y",this.constrainKnob_(e));
this.onScroll_()}a.stopPropagation()};
Blockly.ScrollbarSvg.prototype.onMouseDownKnob_=function(a){Blockly.hideChaff(!0);this.onMouseUpKnob_();2!=a.button&&(this.startDragKnob=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"x":"y")),this.startDragMouse=this.horizontal_?a.clientX:a.clientY,Blockly.ScrollbarSvg.onMouseUpWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mouseup",this,this.onMouseUpKnob_),Blockly.ScrollbarSvg.onMouseMoveWrapper_=Blockly.bindEvent_(Blockly.svgDoc,"mousemove",this,this.onMouseMoveKnob_));a.stopPropagation()};
Blockly.ScrollbarSvg.prototype.onMouseMoveKnob_=function(a){this.svgKnob_.setAttribute(this.horizontal_?"x":"y",this.constrainKnob_(this.startDragKnob+((this.horizontal_?a.clientX:a.clientY)-this.startDragMouse)));this.onScroll_()};
Blockly.ScrollbarSvg.prototype.onMouseUpKnob_=function(){Blockly.ScrollbarSvg.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.ScrollbarSvg.onMouseUpWrapper_),Blockly.ScrollbarSvg.onMouseUpWrapper_=null);Blockly.ScrollbarSvg.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.ScrollbarSvg.onMouseMoveWrapper_),Blockly.ScrollbarSvg.onMouseMoveWrapper_=null)};
Blockly.ScrollbarSvg.prototype.constrainKnob_=function(a){if(0>=a||isNaN(a))a=0;else var b=this.horizontal_?"width":"height",c=parseFloat(this.svgBackground_.getAttribute(b)),b=parseFloat(this.svgKnob_.getAttribute(b)),a=Math.min(a,c-b);return a};
Blockly.ScrollbarSvg.prototype.onScroll_=function(){var a=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"x":"y")),b=parseFloat(this.svgBackground_.getAttribute(this.horizontal_?"width":"height")),a=a/b;isNaN(a)&&(a=0);b={};this.horizontal_?b.x=a:b.y=a;this.setMetrics_(b)};Blockly.ScrollbarSvg.prototype.set=function(a,b){this.svgKnob_.setAttribute(this.horizontal_?"x":"y",a*this.ratio_);if(b)this.onScroll_()};Blockly.ScrollbarSvg.scrollbarThickness=15;Blockly.Scrollbar={};
(function(){var a=!1,b=-1!=window.navigator.userAgent.indexOf("Gecko/"),c="MacIntel"==window.navigator.platform,d=-1!=window.navigator.platform.indexOf("Linux");if(b&&(c||d))a=!0;Blockly.Scrollbar=a?Blockly.ScrollbarNative:Blockly.ScrollbarSvg})();Blockly.Scrollbar.insertAfter_=function(a,b){var c=b.nextSibling,d=b.parentNode;if(!d)throw"Reference node has no parent.";c?d.insertBefore(a,c):d.appendChild(a)};Blockly.Toolbox={};Blockly.Toolbox.width=0;Blockly.Toolbox.selectedOption_=null;
Blockly.Toolbox.createDom=function(){Blockly.Toolbox.flyout_=new Blockly.Flyout;var a=Blockly.createSvgElement("g",{},null);Blockly.Toolbox.svgGroup_=a;var b=Blockly.Toolbox.flyout_.createDom();a.appendChild(b);Blockly.Toolbox.svgBackground_=Blockly.createSvgElement("rect",{"class":"blocklyToolboxBackground",height:"100%"},a);Blockly.Toolbox.svgOptions_=Blockly.createSvgElement("g",{"class":"blocklyToolboxOptions"},a);return a};
Blockly.Toolbox.getMetrics=function(){var a=Blockly.svgSize().height,b=Blockly.Toolbox.width;try{var c=Blockly.Toolbox.svgOptions_.getBBox()}catch(d){return null}return{viewHeight:a,viewWidth:b,contentHeight:c.height+c.y,viewTop:-Blockly.Toolbox.svgOptions_.scrollY,contentTop:0,absoluteTop:0,absoluteLeft:Blockly.RTL?-1:1}};
Blockly.Toolbox.setMetrics=function(a){var b=Blockly.Toolbox.getMetrics();"number"==typeof a.y&&(Blockly.Toolbox.svgOptions_.scrollY=-b.contentHeight*a.y-b.contentTop);Blockly.Toolbox.svgOptions_.setAttribute("transform","translate(0,"+(Blockly.Toolbox.svgOptions_.scrollY+b.absoluteTop)+")")};
Blockly.Toolbox.init=function(){Blockly.Toolbox.flyout_.init(Blockly.mainWorkspace,Blockly.getMainWorkspaceMetrics);Blockly.Toolbox.languageTree=Blockly.Toolbox.buildTree_();Blockly.Toolbox.redraw();new Blockly.Scrollbar(Blockly.Toolbox.svgOptions_,Blockly.Toolbox.getMetrics,Blockly.Toolbox.setMetrics,!1,!1);Blockly.Toolbox.position_();Blockly.bindEvent_(window,"resize",null,Blockly.Toolbox.position_)};
Blockly.Toolbox.position_=function(){var a=Blockly.svgSize();Blockly.RTL&&Blockly.Toolbox.svgGroup_.setAttribute("transform","translate("+(a.width-Blockly.Toolbox.width)+",0)")};Blockly.Toolbox.PREFIX_="cat_";Blockly.Toolbox.buildTree_=function(){var a={},b;for(b in Blockly.Language){var c=Blockly.Language[b];c.category&&(c=Blockly.Toolbox.PREFIX_+window.encodeURI(c.category),c in a?a[c].push(b):a[c]=[b])}return a};
Blockly.Toolbox.redraw=function(){function a(a){return function(b){var c=Blockly.Toolbox.selectedOption_;Blockly.hideChaff();c==a?Blockly.Toolbox.clearSelection():Blockly.Toolbox.selectOption_(a);b.stopPropagation()}}var b=[],c;for(c in Blockly.Toolbox.languageTree){var d={};d.text=window.decodeURI(c.substring(Blockly.Toolbox.PREFIX_.length));d.cat=c;b.push(d)}d={};(Blockly.Language.variables_get||Blockly.Language.variables_set)&&b.push({text:Blockly.MSG_VARIABLE_CATEGORY,cat:Blockly.MSG_VARIABLE_CATEGORY});
(Blockly.Language.procedures_defnoreturn||Blockly.Language.procedures_defreturn)&&b.push({text:Blockly.MSG_PROCEDURE_CATEGORY,cat:Blockly.MSG_PROCEDURE_CATEGORY});Blockly.removeChildren_(Blockly.Toolbox.svgOptions_);c=0;for(var e=[Blockly.Toolbox.svgBackground_],f=0;d=b[f];f++){var g=Blockly.ContextMenu.optionToDom(d.text),h=g.firstChild,i=g.lastChild;Blockly.Toolbox.svgOptions_.appendChild(g);g.setAttribute("transform","translate(0, "+(f*Blockly.ContextMenu.Y_HEIGHT+4)+")");g.cat=d.cat;Blockly.bindEvent_(g,
"mousedown",null,a(g));e.push(h);c=Math.max(c,i.getComputedTextLength())}c+=2*Blockly.ContextMenu.X_PADDING;for(f=0;f<e.length;f++)e[f].setAttribute("width",c);if(Blockly.RTL)for(f=0;g=Blockly.Toolbox.svgOptions_.childNodes[f];f++)i=g.lastChild,i.setAttribute("x",c-i.getComputedTextLength()-Blockly.ContextMenu.X_PADDING);Blockly.Toolbox.width=c;Blockly.bindEvent_(Blockly.Toolbox.svgGroup_,"mousedown",null,function(a){2==a.button&&(Blockly.hideChaff(!0),a.stopPropagation())});Blockly.fireUiEvent(Blockly.svgDoc,
window,"resize")};Blockly.Toolbox.selectOption_=function(a){Blockly.Toolbox.clearSelection();if(Blockly.Toolbox.selectedOption_=a)Blockly.addClass_(a,"blocklyMenuSelected"),a=a.cat,Blockly.Toolbox.flyout_.show(Blockly.Toolbox.languageTree[a]||a)};Blockly.Toolbox.clearSelection=function(){var a=Blockly.Toolbox.selectedOption_;a&&(Blockly.removeClass_(a,"blocklyMenuSelected"),Blockly.Toolbox.selectedOption_=null);Blockly.Toolbox.flyout_.hide()};Blockly.Tooltip={};Blockly.Tooltip.mouseOutPid=0;Blockly.Tooltip.showPid=0;Blockly.Tooltip.lastX=0;Blockly.Tooltip.lastY=0;Blockly.Tooltip.visible=!1;Blockly.Tooltip.element=null;Blockly.Tooltip.poisonedElement=null;Blockly.Tooltip.svgGroup_=null;Blockly.Tooltip.svgText_=null;Blockly.Tooltip.svgBackground_=null;Blockly.Tooltip.svgShadow_=null;Blockly.Tooltip.OFFSET_X=0;Blockly.Tooltip.OFFSET_Y=10;Blockly.Tooltip.RADIUS_OK=10;Blockly.Tooltip.HOVER_MS=1E3;Blockly.Tooltip.MARGINS=5;
Blockly.Tooltip.createDom=function(){var a=Blockly.createSvgElement("g",{"class":"blocklyHidden"},null);Blockly.Tooltip.svgGroup_=a;Blockly.Tooltip.svgShadow_=Blockly.createSvgElement("rect",{"class":"blocklyTooltipShadow",x:2,y:2},a);Blockly.Tooltip.svgBackground_=Blockly.createSvgElement("rect",{"class":"blocklyTooltipBackground"},a);Blockly.Tooltip.svgText_=Blockly.createSvgElement("text",{"class":"blocklyTooltipText"},a);return a};
Blockly.Tooltip.bindMouseEvents=function(a){Blockly.bindEvent_(a,"mouseover",null,Blockly.Tooltip.onMouseOver_);Blockly.bindEvent_(a,"mouseout",null,Blockly.Tooltip.onMouseOut_);Blockly.bindEvent_(a,"mousemove",null,Blockly.Tooltip.onMouseMove_)};Blockly.Tooltip.onMouseOver_=function(a){for(a=a.target;"object"==typeof a.tooltip;)a=a.tooltip;Blockly.Tooltip.element!=a&&(Blockly.Tooltip.hide(),Blockly.Tooltip.poisonedElement=null,Blockly.Tooltip.element=a);window.clearTimeout(Blockly.Tooltip.mouseOutPid)};
Blockly.Tooltip.onMouseOut_=function(){Blockly.Tooltip.mouseOutPid=window.setTimeout(function(){Blockly.Tooltip.element=null;Blockly.Tooltip.poisonedElement=null;Blockly.Tooltip.hide()},1);window.clearTimeout(Blockly.Tooltip.showPid)};
Blockly.Tooltip.onMouseMove_=function(a){if(Blockly.Tooltip.element&&Blockly.Tooltip.element.tooltip&&!(Blockly.ContextMenu&&Blockly.ContextMenu.visible||0!=Blockly.Block.dragMode_))if(Blockly.Tooltip.visible){var b=Blockly.Tooltip.lastY-a.clientY;Math.sqrt(Math.pow(Blockly.Tooltip.lastX-a.clientX,2)+Math.pow(b,2))>Blockly.Tooltip.RADIUS_OK&&Blockly.Tooltip.hide()}else Blockly.Tooltip.poisonedElement!=Blockly.Tooltip.element&&(window.clearTimeout(Blockly.Tooltip.showPid),Blockly.Tooltip.lastX=a.clientX,
Blockly.Tooltip.lastY=a.clientY,Blockly.Tooltip.showPid=window.setTimeout(Blockly.Tooltip.show_,Blockly.Tooltip.HOVER_MS))};Blockly.Tooltip.hide=function(){Blockly.Tooltip.visible&&(Blockly.Tooltip.visible=!1,Blockly.Tooltip.svgGroup_&&(Blockly.Tooltip.svgGroup_.style.display="none"));window.clearTimeout(Blockly.Tooltip.showPid)};
Blockly.Tooltip.show_=function(){Blockly.Tooltip.poisonedElement=Blockly.Tooltip.element;if(Blockly.Tooltip.svgGroup_){Blockly.removeChildren_(Blockly.Tooltip.svgText_);var a=Blockly.Tooltip.element.tooltip;"function"==typeof a&&(a=a());for(var a=a.split("\n"),b=0;b<a.length;b++){var c=Blockly.createSvgElement("tspan",{dy:"1em",x:Blockly.Tooltip.MARGINS},Blockly.Tooltip.svgText_),d=Blockly.svgDoc.createTextNode(a[b]);c.appendChild(d)}Blockly.Tooltip.visible=!0;Blockly.Tooltip.svgGroup_.style.display=
"block";b=Blockly.Tooltip.svgText_.getBBox();a=2*Blockly.Tooltip.MARGINS+b.width;b=b.height;Blockly.Tooltip.svgBackground_.setAttribute("width",a);Blockly.Tooltip.svgBackground_.setAttribute("height",b);Blockly.Tooltip.svgShadow_.setAttribute("width",a);Blockly.Tooltip.svgShadow_.setAttribute("height",b);b=Blockly.Tooltip.lastX;b=Blockly.RTL?b-(Blockly.Tooltip.OFFSET_X+a):b+Blockly.Tooltip.OFFSET_X;a=Blockly.Tooltip.lastY+Blockly.Tooltip.OFFSET_Y;Blockly.svgResize();c=Blockly.svgSize();b-=c.left;
a-=c.top;Blockly.Tooltip.svgGroup_.setAttribute("transform","translate("+b+","+a+")")}};Blockly.Trashcan=function(a){this.getMetrics_=a};Blockly.Trashcan.prototype.BODY_URL_="media/trashbody.png";Blockly.Trashcan.prototype.LID_URL_="media/trashlid.png";Blockly.Trashcan.prototype.WIDTH_=47;Blockly.Trashcan.prototype.BODY_HEIGHT_=45;Blockly.Trashcan.prototype.LID_HEIGHT_=15;Blockly.Trashcan.prototype.MARGIN_BOTTOM_=35;Blockly.Trashcan.prototype.MARGIN_SIDE_=35;Blockly.Trashcan.prototype.isOpen=!1;Blockly.Trashcan.prototype.svgGroup_=null;Blockly.Trashcan.prototype.svgBody_=null;
Blockly.Trashcan.prototype.svgLid_=null;Blockly.Trashcan.prototype.lidTask_=0;Blockly.Trashcan.prototype.lidAngle_=0;Blockly.Trashcan.prototype.left_=0;Blockly.Trashcan.prototype.top_=0;
Blockly.Trashcan.prototype.createDom=function(){this.svgGroup_=Blockly.createSvgElement("g",{filter:"url(#blocklyTrashcanShadowFilter)"},null);this.svgBody_=Blockly.createSvgElement("image",{width:this.WIDTH_,height:this.BODY_HEIGHT_},this.svgGroup_);this.svgBody_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.pathToBlockly+this.BODY_URL_);this.svgBody_.setAttribute("y",this.LID_HEIGHT_);this.svgLid_=Blockly.createSvgElement("image",{width:this.WIDTH_,height:this.LID_HEIGHT_},
this.svgGroup_);this.svgLid_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.pathToBlockly+this.LID_URL_);return this.svgGroup_};Blockly.Trashcan.prototype.init=function(){this.setOpen_(!1);this.position_();Blockly.bindEvent_(window,"resize",this,this.position_)};
Blockly.Trashcan.prototype.position_=function(){var a=this.getMetrics_();a&&(this.left_=Blockly.RTL?this.MARGIN_SIDE_:a.viewWidth+a.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_,this.top_=a.viewHeight+a.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.MARGIN_BOTTOM_,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))};
Blockly.Trashcan.prototype.onMouseMove=function(a){if(this.svgGroup_){var b=Blockly.svgSize(),c=Blockly.getAbsoluteXY_(this.svgGroup_),d=c.x+b.left,b=c.y+b.top,a=a.clientX>d&&a.clientX<d+this.WIDTH_&&a.clientY>b&&a.clientY<b+this.BODY_HEIGHT_+this.LID_HEIGHT_;this.isOpen!=a&&this.setOpen_(a)}};Blockly.Trashcan.prototype.setOpen_=function(a){this.isOpen!=a&&(window.clearTimeout(this.lidTask_),this.isOpen=a,Blockly.Trashcan.animateLid_(this))};
Blockly.Trashcan.animateLid_=function(a){a.lidAngle_+=a.isOpen?10:-10;a.lidAngle_=Math.max(0,a.lidAngle_);a.svgLid_.setAttribute("transform","rotate("+(Blockly.RTL?-a.lidAngle_:a.lidAngle_)+", "+(Blockly.RTL?4:a.WIDTH_-4)+", "+(a.LID_HEIGHT_-2)+")");if(a.isOpen?45>a.lidAngle_:0<a.lidAngle_)this.lidTask_=window.setTimeout(function(){Blockly.Trashcan.animateLid_(a)},5)};Blockly.Trashcan.close=function(a){a.setOpen_(!1)};Blockly.removeChildren_=function(a){for(var b;b=a.firstChild;)a.removeChild(b)};Blockly.addClass_=function(a,b){var c=a.getAttribute("class")||"";-1==(" "+c+" ").indexOf(" "+b+" ")&&(c&&(c+=" "),a.setAttribute("class",c+b))};Blockly.removeClass_=function(a,b){var c=a.getAttribute("class");if(-1!=(" "+c+" ").indexOf(" "+b+" ")){for(var c=c.split(/\s+/),d=0;d<c.length;d++)if(!c[d]||c[d]==b)c.splice(d,1),d--;c.length?a.setAttribute("class",c.join(" ")):a.removeAttribute("class")}};
Blockly.bindEvent_=function(a,b,c,d){var e=[],f;a.addEventListener?(f=function(a){d.apply(c,arguments)},a.addEventListener(b,f,!1),e.push([a,b,f]),b in Blockly.bindEvent_.TOUCH_MAP&&(f=function(a){if(1==a.changedTouches.length){var b=a.changedTouches[0];a.clientX=b.clientX;a.clientY=b.clientY}d.apply(c,arguments);a.preventDefault()},a.addEventListener(Blockly.bindEvent_.TOUCH_MAP[b],f,!1),e.push([a,Blockly.bindEvent_.TOUCH_MAP[b],f]))):(f=function(a){d.apply(c,arguments);a.stopPropagation()},a.attachEvent("on"+
b,f),e.push([a,b,f]));return e};Blockly.bindEvent_.TOUCH_MAP="ontouchstart"in document.documentElement?{mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}:{};Blockly.unbindEvent_=function(a){for(;a.length;){var b=a.pop(),c=b[0],d=b[1],b=b[2];c.removeEventListener?c.removeEventListener(d,b,!1):c.detachEvent("on"+d,b)}};
Blockly.fireUiEvent=function(a,b,c){if(a.createEvent)a=a.createEvent("UIEvents"),a.initEvent(c,!0,!0),b.dispatchEvent(a);else if(a.createEventObject)a=a.createEventObject(),b.fireEvent("on"+c,a);else throw"FireEvent: No event creation mechanism.";};Blockly.noEvent=function(a){a.preventDefault();a.stopPropagation()};
Blockly.getRelativeXY_=function(a){var b={x:0,y:0},c=a.getAttribute("x");c&&(b.x=parseInt(c,10));if(c=a.getAttribute("y"))b.y=parseInt(c,10);if(a=(a=a.getAttribute("transform"))&&a.match(/translate\(\s*([-\d.]+)(,\s*([-\d.]+)\s*\))?/))b.x+=parseInt(a[1],10),a[3]&&(b.y+=parseInt(a[3],10));return b};Blockly.getAbsoluteXY_=function(a){var b=0,c=0;do var d=Blockly.getRelativeXY_(a),b=b+d.x,c=c+d.y,a=a.parentNode;while(a&&a!=Blockly.svgDoc);return{x:b,y:c}};
Blockly.createSvgElement=function(a,b,c){var a=Blockly.svgDoc.createElementNS(Blockly.SVG_NS,a),d;for(d in b)a.setAttribute(d,b[d]);c&&c.appendChild(a);return a};Blockly.caseInsensitiveComparator=function(a,b){a=a.toLowerCase();b=b.toLowerCase();return a>b?1:a<b?-1:0};Blockly.uniqueId=function(){for(var a="abcdefghijklmnopqrstuvwxyz",b=a.charAt(Math.random()*a.length),a=a+"0123456789-_:.",c=1;8>c;c++)b+=a.charAt(Math.random()*a.length);-1!=b.indexOf("--")&&(b=Blockly.uniqueId());return b};Blockly.Variables={};Blockly.Variables.NAME_TYPE="variable";Blockly.Variables.allVariables=function(a){var b;b=a?a.getDescendants():Blockly.mainWorkspace.getAllBlocks();for(var a={},c=0;c<b.length;c++){var d=b[c].getVars;if(d)for(var d=d.call(b[c]),e=0;e<d.length;e++){var f=d[e];f&&(a[Blockly.Names.PREFIX_+f.toLowerCase()]=f)}}b=[];for(var g in a)b.push(a[g]);return b};
Blockly.Variables.dropdownCreate=function(){var a=Blockly.Variables.allVariables(),b=this.getText();b&&-1==a.indexOf(b)&&a.push(b);a.sort(Blockly.caseInsensitiveComparator);a.push(Blockly.MSG_RENAME_VARIABLE);a.push(Blockly.MSG_NEW_VARIABLE);for(var b=[],c=0;c<a.length;c++)b[c]=[a[c],a[c]];return b};
Blockly.Variables.dropdownChange=function(a){function b(a,b){Blockly.hideChaff();var c=window.prompt(a,b);return c&&c.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}if(a==Blockly.MSG_RENAME_VARIABLE){var c=this.getText();(a=b(Blockly.MSG_RENAME_VARIABLE_TITLE.replace("%1",c),c))&&Blockly.Variables.renameVariable(c,a)}else a==Blockly.MSG_NEW_VARIABLE&&(a=b(Blockly.MSG_NEW_VARIABLE_TITLE,""),Blockly.Variables.renameVariable(a,a)),a&&this.setText(a);window.setTimeout(Blockly.Variables.refreshFlyoutCategory,1)};
Blockly.Variables.renameVariable=function(a,b){for(var c=Blockly.mainWorkspace.getAllBlocks(),d=0;d<c.length;d++){var e=c[d].renameVar;e&&e.call(c[d],a,b)}};
Blockly.Variables.flyoutCategory=function(a,b,c,d){var e=Blockly.Variables.allVariables();e.sort(Blockly.caseInsensitiveComparator);e.unshift(null);for(var f=void 0,g=0;g<e.length;g++)if(e[g]!==f){var h=Blockly.Language.variables_get?new Blockly.Block(d,"variables_get"):null;h&&h.initSvg();var i=Blockly.Language.variables_set?new Blockly.Block(d,"variables_set"):null;i&&i.initSvg();null===e[g]?f=(h||i).getVars()[0]:(h&&h.setTitleText(e[g],"VAR"),i&&i.setTitleText(e[g],"VAR"));i&&a.push(i);h&&a.push(h);
h&&i?b.push(c,3*c):b.push(2*c)}};Blockly.Variables.refreshFlyoutCategory=function(){Blockly.Toolbox&&(Blockly.Toolbox.flyout_.isVisible()&&Blockly.Toolbox.selectedOption_.cat==Blockly.MSG_VARIABLE_CATEGORY)&&(Blockly.Toolbox.flyout_.hide(),Blockly.Toolbox.flyout_.show(Blockly.MSG_VARIABLE_CATEGORY))};Blockly.Workspace=function(a){this.editable=a;this.topBlocks_=[];Blockly.ConnectionDB.init(this)};Blockly.Workspace.prototype.dragMode=!1;Blockly.Workspace.prototype.scrollX=0;Blockly.Workspace.prototype.scrollY=0;Blockly.Workspace.prototype.trashcan=null;Blockly.Workspace.prototype.createDom=function(){this.svgGroup_=Blockly.createSvgElement("g",{},null);this.svgBlockCanvas_=Blockly.createSvgElement("g",{},this.svgGroup_);return this.svgGroup_};
Blockly.Workspace.prototype.addTrashcan=function(a){Blockly.Trashcan&&this.editable&&(this.trashcan=new Blockly.Trashcan(a),a=this.trashcan.createDom(),this.svgGroup_.insertBefore(a,this.svgBlockCanvas_),this.trashcan.init())};Blockly.Workspace.prototype.getCanvas=function(){return this.svgBlockCanvas_};Blockly.Workspace.prototype.addTopBlock=function(a){this.topBlocks_.push(a)};
Blockly.Workspace.prototype.removeTopBlock=function(a){for(var b=!1,c,d=0;c=this.topBlocks_[d];d++)if(c==a){this.topBlocks_.splice(d,1);b=!0;break}if(!b)throw"Block not present in workspace's list of top-most blocks.";};Blockly.Workspace.prototype.getTopBlocks=function(a){var b=[].concat(this.topBlocks_);a&&1<b.length&&b.sort(function(a,b){return a.getRelativeToSurfaceXY().y-b.getRelativeToSurfaceXY().y});return b};
Blockly.Workspace.prototype.getAllBlocks=function(){for(var a=this.getTopBlocks(!1),b=0;b<a.length;b++)a=a.concat(a[b].getChildren());return a};Blockly.Workspace.prototype.clear=function(){for(Blockly.hideChaff();this.topBlocks_.length;)this.topBlocks_[0].destroy()};Blockly.Workspace.prototype.render=function(){for(var a=this.getAllBlocks(),b=0,c;c=a[b];b++)c.getChildren().length||c.render()};
Blockly.Workspace.prototype.getBlockById=function(a){for(var b=this.getAllBlocks(),c=0,d;d=b[c];c++)if(d.id==a)return d;return null};Blockly.Workspace.prototype.traceOn=function(a){this.traceOn_=a;this.traceWrapper_&&(Blockly.unbindEvent_(this.traceWrapper_),this.traceWrapper_=null);a&&(this.traceWrapper_=Blockly.bindEvent_(this.svgBlockCanvas_,"blocklySelectChange",this,function(){this.traceOn_=false}))};
Blockly.Workspace.prototype.highlightBlock=function(a){if(this.traceOn_&&(a=this.getBlockById(a)))this.traceOn(!1),a.select(),this.traceOn(!0)};Blockly.Xml={};Blockly.Xml.workspaceToDom=function(a){for(var b=document.createElement("xml"),a=a.getTopBlocks(!1),c=0,d;d=a[c];c++){var e=Blockly.Xml.blockToDom_(d);d=d.getRelativeToSurfaceXY();e.setAttribute("x",Blockly.RTL?-d.x:d.x);e.setAttribute("y",d.y);b.appendChild(e)}return b};
Blockly.Xml.blockToDom_=function(a){function b(a){if(a.name&&a.EDITABLE){var b=document.createElement("title");b.setAttribute("name",a.name);a=document.createTextNode(a.getValue());b.appendChild(a);c.appendChild(b)}}var c=document.createElement("block");c.setAttribute("type",a.type);if(a.mutationToDom){var d=a.mutationToDom();d&&c.appendChild(d)}for(var d=0,e;e=a.titleRow[d];d++)b(e);for(d=0;e=a.inputList[d];d++)e.label&&b(e.label);a.comment&&(d=document.createElement("comment"),e=document.createTextNode(a.comment.getText()),
d.appendChild(e),d.setAttribute("pinned",a.comment.isPinned()),e=a.comment.getBubbleLocation(),d.setAttribute("x",e.x),d.setAttribute("y",e.y),e=a.comment.getBubbleSize(),d.setAttribute("h",e.height),d.setAttribute("w",e.width),c.appendChild(d));for(var f=!1,d=0;e=a.inputList[d];d++){var g,h=!0;if(e.type!=Blockly.DUMMY_INPUT){if(e.type==Blockly.LOCAL_VARIABLE)g=document.createElement("variable"),g.setAttribute("data",e.getText()),h=!1;else{var i=e.targetBlock();e.type==Blockly.INPUT_VALUE?(g=document.createElement("value"),
f=!0):e.type==Blockly.NEXT_STATEMENT&&(g=document.createElement("statement"));i&&(g.appendChild(Blockly.Xml.blockToDom_(i)),h=!1)}g.setAttribute("name",e.name);h||c.appendChild(g)}}f&&c.setAttribute("inline",a.inputsInline);a.collapsed&&c.setAttribute("collapsed",!0);if(a.nextConnection&&(a=a.nextConnection.targetBlock()))g=document.createElement("next"),g.appendChild(Blockly.Xml.blockToDom_(a)),c.appendChild(g);return c};Blockly.Xml.domToText=function(a){return(new XMLSerializer).serializeToString(a)};
Blockly.Xml.domToPrettyText=function(a){for(var a=Blockly.Xml.domToText(a).split("<"),b="",c=1;c<a.length;c++){var d=a[c][0];"/"==d&&(b=b.substring(2));a[c]=b+"<"+a[c];"/"!=d&&(b+="  ")}a=a.join("\n");a=a.replace(/(<(\w+)[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>");return a.replace(/^\n/,"")};
Blockly.Xml.textToDom=function(a){a=(new DOMParser).parseFromString(a,"text/xml");if(!a||!a.firstChild||"xml"!=a.firstChild.tagName||a.firstChild!==a.lastChild)throw"Blockly.Xml.textToDom did not obtain a valid XML tree.";return a.firstChild};
Blockly.Xml.domToWorkspace=function(a,b){for(var c=0,d;d=b.childNodes[c];c++)if(d.nodeName&&"block"==d.nodeName.toLowerCase()){var e=Blockly.Xml.domToBlock_(a,d),f=parseInt(d.getAttribute("x"),10);d=parseInt(d.getAttribute("y"),10);!isNaN(f)&&!isNaN(d)&&e.moveBy(Blockly.RTL?-f:f,d)}};
Blockly.Xml.domToBlock_=function(a,b){var c=b.getAttribute("type"),c=new Blockly.Block(a,c);c.initSvg();var d=b.getAttribute("inline");d&&c.setInputsInline("true"==d);(d=b.getAttribute("collapsed"))&&c.setCollapsed("true"==d);for(var d=0,e;e=b.childNodes[d];d++)if(!(3==e.nodeType&&e.data.match(/^\s*$/))){for(var f=null,f=null,g=0,h;h=e.childNodes[g];g++)if(3!=h.nodeType||!h.data.match(/^\s*$/))f=h;g=e.getAttribute("name");switch(e.tagName.toLowerCase()){case "mutation":c.domToMutation&&c.domToMutation(e);
break;case "comment":c.setCommentText(e.textContent);(f=e.getAttribute("pinned"))&&c.comment.setPinned("true"==f);f=parseInt(e.getAttribute("x"),10);g=parseInt(e.getAttribute("y"),10);!isNaN(f)&&!isNaN(g)&&c.comment.setBubbleLocation(f,g,!1);f=parseInt(e.getAttribute("w"),10);e=parseInt(e.getAttribute("h"),10);!isNaN(f)&&!isNaN(e)&&c.comment.setBubbleSize(f,e);break;case "title":c.setTitleValue(e.textContent,g);break;case "variable":f=e.getAttribute("data");if(null!==f){e=c.getInput(g);if(!e)throw"Variable input does not exist.";
e.setText(f)}break;case "value":case "statement":e=c.getInput(g);if(!e)throw"Input does not exist.";if(f&&f.tagName&&"block"==f.tagName.toLowerCase())if(f=Blockly.Xml.domToBlock_(a,f),f.outputConnection)e.connect(f.outputConnection);else if(f.previousConnection)e.connect(f.previousConnection);else throw"Child block does not have output or previous statement.";break;case "next":if(f&&f.tagName&&"block"==f.tagName.toLowerCase()){if(c.nextConnection){if(c.nextConnection.targetConnection)throw"Next statement is already connected.";
}else throw"Next statement does not exist.";f=Blockly.Xml.domToBlock_(a,f);if(!f.previousConnection)throw"Next block does not have previous statement.";c.nextConnection.connect(f.previousConnection)}}}c.render();return c};Blockly.Xml.isFirstRealChild_=function(a,b){for(var c=0,d;d=a.childNodes[c];c++)if(3!=d.nodeType||!d.data.match(/^\s*$/))return d.tagName&&d.tagName.toLowerCase()==b;return!1};